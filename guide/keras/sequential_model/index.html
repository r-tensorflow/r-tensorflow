<!doctype html><html><head><script>theBaseUrl=location.origin+"/";</script><meta charset=utf-8><meta name=viewport content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1"><title>Guide to the Sequential Model</title><meta name=generator content="Hugo 0.58.3"><meta name=description content="Documentation for the TensorFlow for R interface"><link rel=canonical href=/guide/keras/sequential_model/><meta name=author content="J.J. Allaire"><meta property=og:url content=/guide/keras/sequential_model/><meta property=og:title content="TensorFlow for R"><meta name=apple-mobile-web-app-title content="TensorFlow for R"><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=black-translucent><style>@font-face{font-family:icon;src:url(fonts/icon.eot?52m981);src:url(fonts/icon.eot?#iefix52m981) format('embedded-opentype'),url(fonts/icon.woff?52m981) format('woff'),url(fonts/icon.ttf?52m981) format('truetype'),url(fonts/icon.svg?52m981#icon) format('svg');font-weight:400;font-style:normal}</style><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/site-styles.css><script src=/js/vendor.js></script><script src=/js/app.js></script><link rel="shortcut icon" href=/images/favicon.png><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script></head><body><div class=single-page><nav data-gumshoe-header aria-label=Header id=header class=top-menu><div class=left><a href=/ data-parenturl class="top-menu-item site-title">TensorFlow for R</a>
<span class=logo-from>from</span>
<a href=/><div id=logo class=logo></div></a></div><div class=right><div class=top-menu-items id=top-menu-items><a href=/ data-parenturl=/ class=top-menu-item>Home</a>
<a href=/installation/ data-parenturl=/installation/ class=top-menu-item>Installation</a>
<a href=/tutorials/ data-parenturl=/tutorials/ class=top-menu-item>Tutorials</a>
<a href=/guide/ data-parenturl=/guide/ class=top-menu-item>Guide</a>
<a href=/deploy/ data-parenturl=/deploy/ class=top-menu-item>Deploy</a>
<a href=/tools/ data-parenturl=/tools/ class=top-menu-item>Tools</a>
<a href=/reference/keras data-parenturl=/reference/keras class=top-menu-item>API</a>
<a href=/learn/resources/ data-parenturl=/learn/resources/ class=top-menu-item>Learn</a>
<a href=/blog.html data-parenturl=/blog.html class=top-menu-item>Blog</a></div><a href=https://github.com/rstudio/keras class=github-logo><i class="fa fa-lg fa-github" aria-hidden=true></i></a><div class=search-button><i class="fa fa-lg fa-search"></i></div></div></nav><nav aria-label=Header id=mobile-header><a href=/>TensorFlow for R</a><div class=right><a href=https://github.com/rstudio/keras class=github-logo><i class="fa fa-lg fa-github" aria-hidden=true></i></a><div class=hamburger><i class="fa fa-lg fa-bars" aria-hidden=true></i></div></div></nav><div id=mobile-menu-container><ul id=mobile-menu><li><a href=/>Home</a></li><ul></ul><li><a href=/installation/>Installation</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/installation/>Installing TensorFlow</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/installation/>Quick start</a></li><li><a href=/installation/custom/>Custom Installation</a></li></ul><li><a href=/installation/gpu>Using a GPU</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/installation/gpu/>Overview</a></li><li><a href=/installation/gpu/local_gpu/>Local GPU</a></li><li><a href=/installation/gpu/cloud_server_gpu/>Cloud Server</a></li><li><a href=/installation/gpu/cloud_desktop_gpu/>Cloud Desktop</a></li></ul></ul><li><a href=/tutorials/>Tutorials</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/>Overview</a></li><li><a href>Beginners</a></li><li><a href=/tutorials/beginners/>Quickstart</a></li><li><a href=/tutorials/beginners/basic-ml/>Basic ML with Keras</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/beginners/basic-ml/>Overview</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_basic_classification/>Image Classification</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_basic_regression/>Regression</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_basic_text_classification/>Text Classification</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_basic_text_classification_with_tfhub/>Transfer learning with tfhub</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_overfit_underfit/>Overfitting and Underfitting</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_save_and_restore/>Save and Restore Models</a></li></ul><li><a href=/tutorials/beginners/load/load_csv/>Load and preprocess data</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/beginners/load/load_csv/>Load CSV data</a></li><li><a href=/tutorials/beginners/load/load_image/>Load image data</a></li></ul><li><a href>Advanced</a></li><li><a href=/tutorials/advanced/>Quickstart</a></li><li><a href=/tutorials/advanced/customization/tensors-operations/>Customization</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/advanced/customization/tensors-operations/>Tensors and operations</a></li><li><a href=/tutorials/advanced/customization/custom-layers/>Custom layers</a></li><li><a href=/tutorials/advanced/customization/autodiff/>Automatic differentiation</a></li><li><a href=/tutorials/advanced/customization/custom-training/>Custom training</a></li></ul><li><a href=/tutorials/advanced/images/cnn/>Images</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/advanced/images/cnn/>Convolutional Neural Network</a></li><li><a href=/tutorials/advanced/images/transfer-learning-hub/>Transfer Learning with tfhub</a></li></ul><li><a href=/tutorials/advanced/structured/classify/>Structured data</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/advanced/structured/classify/>Classify structured data</a></li></ul><li><a href=/tutorials/advanced/distributed/distributed_training_with_keras/>Distributed training</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/advanced/distributed/distributed_training_with_keras/>Distributed training with Keras</a></li></ul></ul><li><a href=/guide/>Guide</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/>Overview</a></li><li><a href>Keras</a></li><li><a href=/guide/keras/>Getting started</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/keras/>Overview</a></li><li><a href=/guide/keras/guide_keras/>Keras basics</a></li><li><a href=/guide/keras/sequential_model/>Sequential API</a></li><li><a href=/guide/keras/functional_api/>Functional API</a></li><li><a href=/guide/keras/saving_serializing/>Saving and serializing models</a></li><li><a href=/guide/keras/faq/>Frequently Asked Questions</a></li></ul><li><a href=/guide/keras/custom_layers/>Advanced</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/keras/custom_layers/>Custom Layers</a></li><li><a href=/guide/keras/custom_models/>Custom Models</a></li><li><a href=/guide/keras/training_callbacks/>Training Callbacks</a></li><li><a href=/guide/keras/applications/>Pre-Trained Models</a></li><li><a href=/guide/keras/training_visualization/>Training Visualization</a></li><li><a href=/guide/keras/mixed_precision/>Mixed Precision Training</a></li></ul><li><a href=/guide/keras/examples/>Examples</a></li><li><a href>TensorFlow Mechanics</a></li><li><a href=/guide/tensorflow/eager_execution>Basics</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tensorflow/eager_execution/>Eager execution</a></li><li><a href=/guide/tensorflow/variable/>Variables</a></li><li><a href=/guide/tensorflow/tensors/>Tensors</a></li></ul><li><a href=/guide/tensorflow/ragged_tensors>Advanced</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tensorflow/ragged_tensors/>Ragged tensors</a></li></ul><li><a href>Data input pipeline</a></li><li><a href=/guide/tfdatasets/introduction>Overview</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tfdatasets/introduction/>Using Datasets</a></li></ul><li><a href=/guide/tfdatasets/feature_spec>Feature spec API</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tfdatasets/feature_spec/>Feature Spec interface</a></li><li><a href=/guide/tfdatasets/feature_columns/>Feature columns</a></li></ul><li><a href>TensorFlow Hub</a></li><li><a href=/guide/tfhub/intro>Basics</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tfhub/intro/>Overview</a></li><li><a href=/guide/tfhub/hub-with-keras/>Using with Keras</a></li></ul><li><a href=/guide/tfhub/key-concepts>Key concepts</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tfhub/key-concepts/>Key Concepts</a></li></ul><li><a href=/guide/tfhub/examples/>Examples</a></li><li><a href>Model saving</a></li><li><a href=/guide/saving/checkpoints>Checkpoints</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/saving/checkpoints/>Checkpoints</a></li></ul><li><a href=/guide/saving/saved_model>Saved Model</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/saving/saved_model/>Saved Model</a></li></ul></ul><li><a href=/deploy/>Deploy</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/deploy/>Overview</a></li><li><a href=/deploy/plumber/>Plumber</a></li><li><a href=/deploy/shiny/>Shiny</a></li><li><a href=/deploy/docker/>TensorFlow Serving</a></li><li><a href=/deploy/rsconnect/>RStudio Connect</a></li></ul><li><a href=/tools/>Tools</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tools/>Overview</a></li><li><a href=/tools/tfruns/>Training Runs</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tools/tfruns/overview/>Introduction to tfruns</a></li><li><a href=/tools/tfruns/tuning/>Hyperparameter Tuning</a></li><li><a href=/tools/tfruns/managing/>Managing Training Runs</a></li></ul><li><a href=/tools/cloudml/>Cloud ML</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tools/cloudml/getting_started/>Getting Started</a></li><li><a href=/tools/cloudml/training/>Training with CloudML</a></li><li><a href=/tools/cloudml/tuning/>Hyperparameter Tuning</a></li><li><a href=/tools/cloudml/storage/>Google Cloud Storage</a></li><li><a href=/tools/cloudml/deployment/>Deploying Models</a></li></ul><li><a href=/tools/tensorboard/>Tensorboard</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tools/tensorboard/tensorboard/>Getting started</a></li><li><a href=/tools/tensorboard/hparams/>HParams Dashboard</a></li></ul></ul><li><a href=/reference/keras>API</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/reference/cloudml/>cloudml</a></li><li><a href=/reference/keras/>keras</a></li><li><a href=/reference/tensorflow/>tensorflow</a></li><li><a href=/reference/tfdatasets/>tfdatasets</a></li><li><a href=/reference/tfruns/>tfruns</a></li></ul><li><a href=/learn/resources/>Learn</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/learn/resources/>Resources</a></li></ul><li><a href=/blog.html>Blog</a></li><ul></ul></ul></div><div id=search-bar class=search-bar><p class=search-bar__icon><i class="fa fa-lg fa-search"></i></p><div class=search-bar__input><input type=text name=search class=st-default-search-input></div><div class=search-bar__exit><i class="fa fa-lg fa-times"></i></div><div class=inline-search-results><ul></ul></div></div></div><div class="page documentation"><div class=side-menu id=side-menu><ul class=side-menu-list data-parenturl=/ style=display:none></ul><ul class=side-menu-list data-parenturl=/installation/ style=display:none><li class=side-menu__item><a href=/installation/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Installing TensorFlow</p></a></li><li class=side-menu__item><a href=/installation/gpu class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Using a GPU</p></a></li></ul><ul class=side-menu-list data-parenturl=/tutorials/ style=display:none><li class=side-menu__item><a href=/tutorials/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Overview</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">Beginners</p></span></li><li class=side-menu__item><a href=/tutorials/beginners/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Quickstart</p></a></li><li class=side-menu__item><a href=/tutorials/beginners/basic-ml/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Basic ML with Keras</p></a></li><li class=side-menu__item><a href=/tutorials/beginners/load/load_csv/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Load and preprocess data</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">Advanced</p></span></li><li class=side-menu__item><a href=/tutorials/advanced/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Quickstart</p></a></li><li class=side-menu__item><a href=/tutorials/advanced/customization/tensors-operations/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Customization</p></a></li><li class=side-menu__item><a href=/tutorials/advanced/images/cnn/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Images</p></a></li><li class=side-menu__item><a href=/tutorials/advanced/structured/classify/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Structured data</p></a></li><li class=side-menu__item><a href=/tutorials/advanced/distributed/distributed_training_with_keras/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Distributed training</p></a></li></ul><ul class=side-menu-list data-parenturl=/guide/ style=display:none><li class=side-menu__item><a href=/guide/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Overview</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">Keras</p></span></li><li class="side-menu__item active"><a href=/guide/keras/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Getting started</p></a><ul class=side-menu__sub><span style=display:none>guide</span><li class=side-menu__sub__item><a id=menu-link-/guide/keras/ class=side-menu__sub__item__text href=/guide/keras/ data-url=/guide/keras/>Overview</a></li><span style=display:none>guide</span><li class=side-menu__sub__item><a id=menu-link-/guide/keras/guide_keras/ class=side-menu__sub__item__text href=/guide/keras/guide_keras/ data-url=/guide/keras/guide_keras/>Keras basics</a></li><span style=display:none>guide</span><li class="side-menu__sub__item active"><a id=menu-link-/guide/keras/sequential_model/ class=side-menu__sub__item__text href=/guide/keras/sequential_model/ data-url=/guide/keras/sequential_model/>Sequential API</a></li><span style=display:none>guide</span><li class=side-menu__sub__item><a id=menu-link-/guide/keras/functional_api/ class=side-menu__sub__item__text href=/guide/keras/functional_api/ data-url=/guide/keras/functional_api/>Functional API</a></li><span style=display:none>guide</span><li class=side-menu__sub__item><a id=menu-link-/guide/keras/saving_serializing/ class=side-menu__sub__item__text href=/guide/keras/saving_serializing/ data-url=/guide/keras/saving_serializing/>Saving and serializing models</a></li><span style=display:none>guide</span><li class=side-menu__sub__item><a id=menu-link-/guide/keras/faq/ class=side-menu__sub__item__text href=/guide/keras/faq/ data-url=/guide/keras/faq/>Frequently Asked Questions</a></li></ul></li><li class=side-menu__item><a href=/guide/keras/custom_layers/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Advanced</p></a></li><li class=side-menu__item><a href=/guide/keras/examples/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Examples</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">TensorFlow Mechanics</p></span></li><li class=side-menu__item><a href=/guide/tensorflow/eager_execution class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Basics</p></a></li><li class=side-menu__item><a href=/guide/tensorflow/ragged_tensors class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Advanced</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">Data input pipeline</p></span></li><li class=side-menu__item><a href=/guide/tfdatasets/introduction class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Overview</p></a></li><li class=side-menu__item><a href=/guide/tfdatasets/feature_spec class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Feature spec API</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">TensorFlow Hub</p></span></li><li class=side-menu__item><a href=/guide/tfhub/intro class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Basics</p></a></li><li class=side-menu__item><a href=/guide/tfhub/key-concepts class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Key concepts</p></a></li><li class=side-menu__item><a href=/guide/tfhub/examples/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Examples</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">Model saving</p></span></li><li class=side-menu__item><a href=/guide/saving/checkpoints class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Checkpoints</p></a></li><li class=side-menu__item><a href=/guide/saving/saved_model class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Saved Model</p></a></li></ul><ul class=side-menu-list data-parenturl=/deploy/ style=display:none><li class=side-menu__item><a href=/deploy/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Overview</p></a></li><li class=side-menu__item><a href=/deploy/plumber/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Plumber</p></a></li><li class=side-menu__item><a href=/deploy/shiny/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Shiny</p></a></li><li class=side-menu__item><a href=/deploy/docker/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>TensorFlow Serving</p></a></li><li class=side-menu__item><a href=/deploy/rsconnect/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>RStudio Connect</p></a></li></ul><ul class=side-menu-list data-parenturl=/tools/ style=display:none><li class=side-menu__item><a href=/tools/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Overview</p></a></li><li class=side-menu__item><a href=/tools/tfruns/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Training Runs</p></a></li><li class=side-menu__item><a href=/tools/cloudml/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Cloud ML</p></a></li><li class=side-menu__item><a href=/tools/tensorboard/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Tensorboard</p></a></li></ul><ul class=side-menu-list data-parenturl=/reference/keras style=display:none><li class=side-menu__item><a href=/reference/cloudml/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>cloudml</p></a></li><li class=side-menu__item><a href=/reference/keras/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>keras</p></a></li><li class=side-menu__item><a href=/reference/tensorflow/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>tensorflow</p></a></li><li class=side-menu__item><a href=/reference/tfdatasets/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>tfdatasets</p></a></li><li class=side-menu__item><a href=/reference/tfruns/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>tfruns</p></a></li></ul><ul class=side-menu-list data-parenturl=/learn/resources/ style=display:none><li class=side-menu__item><a href=/learn/resources/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Resources</p></a></li></ul><ul class=side-menu-list data-parenturl=/blog.html style=display:none></ul></div><div class=content><h1 class=content-header>Guide to the Sequential Model</h1><div class=markdowned><div class=doc-page><div class=doc-page-index><ul id=gumshoe-container data-gumshoe></ul></div><div class=doc-page-body><div id=defining-a-model class="section level2"><h2>Defining a Model</h2><p>The sequential model is a linear stack of layers.</p><p>You create a sequential model by calling the <code><a href=../../keras/reference/keras_model_sequential.html>keras_model_sequential()</a></code> function then a series of <code>layer</code> functions:</p><div class=sourceCode id=cb1><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb1-1 data-line-number=1><span class=kw><a href=https://rdrr.io/r/base/library.html>library</a></span>(keras)</a>
<a class=sourceLine id=cb1-2 data-line-number=2></a>
<a class=sourceLine id=cb1-3 data-line-number=3>model &lt;-<span class=st> </span><span class=kw><a href=../../keras/reference/keras_model_sequential.html>keras_model_sequential</a></span>() </a>
<a class=sourceLine id=cb1-4 data-line-number=4>model <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb1-5 data-line-number=5><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>32</span>, <span class=dt>input_shape =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>784</span>)) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb1-6 data-line-number=6><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_activation.html>layer_activation</a></span>(<span class=st>'relu'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb1-7 data-line-number=7><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>10</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb1-8 data-line-number=8><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_activation.html>layer_activation</a></span>(<span class=st>'softmax'</span>)</a></code></pre></div><p>Note that Keras objects are <a href=faq.html#why-are-keras-objects-modified-in-place>modified in place</a> which is why it’s not necessary for <code>model</code> to be assigned back to after the layers are added.</p><p>Print a summary of the model’s structure using the <code><a href=https://rdrr.io/r/base/summary.html>summary()</a></code> function:</p><div class=sourceCode id=cb2><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb2-1 data-line-number=1><span class=kw><a href=https://rdrr.io/r/base/summary.html>summary</a></span>(model)</a></code></pre></div><pre><code>Model
________________________________________________________________________________
Layer (type)                        Output Shape                    Param #     
================================================================================
dense_1 (Dense)                     (None, 256)                     200960      
________________________________________________________________________________
dropout_1 (Dropout)                 (None, 256)                     0           
________________________________________________________________________________
dense_2 (Dense)                     (None, 128)                     32896       
________________________________________________________________________________
dropout_2 (Dropout)                 (None, 128)                     0           
________________________________________________________________________________
dense_3 (Dense)                     (None, 10)                      1290        
================================================================================
Total params: 235,146
Trainable params: 235,146
Non-trainable params: 0
________________________________________________________________________________</code></pre><div id=input-shapes class="section level3"><h3>Input Shapes</h3><p>The model needs to know what input shape it should expect. For this reason, the first layer in a sequential model (and only the first, because following layers can do automatic shape inference) needs to receive information about its input shape.</p><p>As illustrated in the example above, this is done by passing an <code>input_shape</code> argument to the first layer. This is a list of integers or <code>NULL</code> entries, where <code>NULL</code> indicates that any positive integer may be expected. In <code>input_shape</code>, the batch dimension is not included.</p><p>If you ever need to specify a fixed batch size for your inputs (this is useful for stateful recurrent networks), you can pass a <code>batch_size</code> argument to a layer. If you pass both <code>batch_size=32</code> and <code>input_shape=c(6, 8)</code> to a layer, it will then expect every batch of inputs to have the batch shape <code>(32, 6, 8)</code>.</p></div></div><div id=compilation class="section level2"><h2>Compilation</h2><p>Before training a model, you need to configure the learning process, which is done via the <code><a href=../../keras/reference/reexports.html>compile()</a></code> function. It receives three arguments:</p><ul><li><p>An optimizer. This could be the string identifier of an existing optimizer (e.g. as “rmsprop” or “adagrad”) or a call to an optimizer function (e.g. <code><a href=../../keras/reference/optimizer_sgd.html>optimizer_sgd()</a></code>).</p></li><li><p>A loss function. This is the objective that the model will try to minimize. It can be the string identifier of an existing loss function (e.g. “categorical_crossentropy” or “mse”) or a call to a loss function (e.g. <code><a href=../../keras/reference/loss_mean_squared_error.html>loss_mean_squared_error()</a></code>).</p></li><li><p>A list of metrics. For any classification problem you will want to set this to <code>metrics = c('accuracy')</code>. A metric could be the string identifier of an existing metric or a call to metric function (e.g. <code><a href=../../keras/reference/metric_binary_accuracy.html>metric_binary_crossentropy()</a></code>).</p></li></ul><p>Here’s the definition of a model along with the compilation step (the <code><a href=../../keras/reference/reexports.html>compile()</a></code> function has arguments appropriate for a multi-class classification problem):</p><div class=sourceCode id=cb4><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb4-1 data-line-number=1><span class=co># For a multi-class classification problem</span></a>
<a class=sourceLine id=cb4-2 data-line-number=2>model &lt;-<span class=st> </span><span class=kw><a href=../../keras/reference/keras_model_sequential.html>keras_model_sequential</a></span>() </a>
<a class=sourceLine id=cb4-3 data-line-number=3>model <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb4-4 data-line-number=4><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>32</span>, <span class=dt>input_shape =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>784</span>)) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb4-5 data-line-number=5><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_activation.html>layer_activation</a></span>(<span class=st>'relu'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb4-6 data-line-number=6><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>10</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb4-7 data-line-number=7><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_activation.html>layer_activation</a></span>(<span class=st>'softmax'</span>)</a>
<a class=sourceLine id=cb4-8 data-line-number=8></a>
<a class=sourceLine id=cb4-9 data-line-number=9>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>compile</a></span>(</a>
<a class=sourceLine id=cb4-10 data-line-number=10>  <span class=dt>optimizer =</span> <span class=st>'rmsprop'</span>,</a>
<a class=sourceLine id=cb4-11 data-line-number=11>  <span class=dt>loss =</span> <span class=st>'categorical_crossentropy'</span>,</a>
<a class=sourceLine id=cb4-12 data-line-number=12>  <span class=dt>metrics =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=st>'accuracy'</span>)</a>
<a class=sourceLine id=cb4-13 data-line-number=13>)</a></code></pre></div><p>Here’s what compilation might look like for a mean squared error regression problem:</p><div class=sourceCode id=cb5><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb5-1 data-line-number=1>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>compile</a></span>(</a>
<a class=sourceLine id=cb5-2 data-line-number=2>  <span class=dt>optimizer =</span> <span class=kw><a href=../../keras/reference/optimizer_rmsprop.html>optimizer_rmsprop</a></span>(<span class=dt>lr =</span> <span class=fl>0.002</span>),</a>
<a class=sourceLine id=cb5-3 data-line-number=3>  <span class=dt>loss =</span> <span class=st>'mse'</span></a>
<a class=sourceLine id=cb5-4 data-line-number=4>)</a></code></pre></div><p>Here’s compilation for a binary classification problem:</p><div class=sourceCode id=cb6><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb6-1 data-line-number=1>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>compile</a></span>( </a>
<a class=sourceLine id=cb6-2 data-line-number=2>  <span class=dt>optimizer =</span> <span class=kw><a href=../../keras/reference/optimizer_rmsprop.html>optimizer_rmsprop</a></span>(),</a>
<a class=sourceLine id=cb6-3 data-line-number=3>  <span class=dt>loss =</span> loss_binary_crossentropy,</a>
<a class=sourceLine id=cb6-4 data-line-number=4>  <span class=dt>metrics =</span> metric_binary_accuracy</a>
<a class=sourceLine id=cb6-5 data-line-number=5>)</a></code></pre></div><p>Here’s compilation with a custom metric:</p><div class=sourceCode id=cb7><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb7-1 data-line-number=1><span class=co># create metric using backend tensor functions</span></a>
<a class=sourceLine id=cb7-2 data-line-number=2>metric_mean_pred &lt;-<span class=st> </span><span class=kw><a href=../../keras/reference/metric_binary_accuracy.html>custom_metric</a></span>(<span class=st>"mean_pred"</span>, <span class=cf>function</span>(y_true, y_pred) {</a>
<a class=sourceLine id=cb7-3 data-line-number=3>  <span class=kw><a href=../../keras/reference/k_mean.html>k_mean</a></span>(y_pred) </a>
<a class=sourceLine id=cb7-4 data-line-number=4>})</a>
<a class=sourceLine id=cb7-5 data-line-number=5></a>
<a class=sourceLine id=cb7-6 data-line-number=6>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>compile</a></span>( </a>
<a class=sourceLine id=cb7-7 data-line-number=7>  <span class=dt>optimizer =</span> <span class=kw><a href=../../keras/reference/optimizer_rmsprop.html>optimizer_rmsprop</a></span>(),</a>
<a class=sourceLine id=cb7-8 data-line-number=8>  <span class=dt>loss =</span> loss_binary_crossentropy,</a>
<a class=sourceLine id=cb7-9 data-line-number=9>  <span class=dt>metrics =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=st>'accuracy'</span>, metric_mean_pred)</a>
<a class=sourceLine id=cb7-10 data-line-number=10>)</a></code></pre></div></div><div id=training class="section level2"><h2>Training</h2><p>Keras models are trained on R matrices or higher dimensional arrays of input data and labels. For training a model, you will typically use the <code><a href=../../keras/reference/reexports.html>fit()</a></code> function.</p><p>Here’s a single-input model with 2 classes (binary classification):</p><div class=sourceCode id=cb8><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb8-1 data-line-number=1><span class=co># create model</span></a>
<a class=sourceLine id=cb8-2 data-line-number=2>model &lt;-<span class=st> </span><span class=kw><a href=../../keras/reference/keras_model_sequential.html>keras_model_sequential</a></span>()</a>
<a class=sourceLine id=cb8-3 data-line-number=3></a>
<a class=sourceLine id=cb8-4 data-line-number=4><span class=co># add layers and compile the model</span></a>
<a class=sourceLine id=cb8-5 data-line-number=5>model <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb8-6 data-line-number=6><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>32</span>, <span class=dt>activation =</span> <span class=st>'relu'</span>, <span class=dt>input_shape =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>100</span>)) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb8-7 data-line-number=7><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>1</span>, <span class=dt>activation =</span> <span class=st>'sigmoid'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb8-8 data-line-number=8><span class=st>  </span><span class=kw><a href=../../keras/reference/reexports.html>compile</a></span>(</a>
<a class=sourceLine id=cb8-9 data-line-number=9>    <span class=dt>optimizer =</span> <span class=st>'rmsprop'</span>,</a>
<a class=sourceLine id=cb8-10 data-line-number=10>    <span class=dt>loss =</span> <span class=st>'binary_crossentropy'</span>,</a>
<a class=sourceLine id=cb8-11 data-line-number=11>    <span class=dt>metrics =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=st>'accuracy'</span>)</a>
<a class=sourceLine id=cb8-12 data-line-number=12>  )</a>
<a class=sourceLine id=cb8-13 data-line-number=13></a>
<a class=sourceLine id=cb8-14 data-line-number=14><span class=co># Generate dummy data</span></a>
<a class=sourceLine id=cb8-15 data-line-number=15>data &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>1000</span><span class=op>*</span><span class=dv>100</span>), <span class=dt>nrow =</span> <span class=dv>1000</span>, <span class=dt>ncol =</span> <span class=dv>100</span>)</a>
<a class=sourceLine id=cb8-16 data-line-number=16>labels &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=kw><a href=https://rdrr.io/r/base/Round.html>round</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>1000</span>, <span class=dt>min =</span> <span class=dv>0</span>, <span class=dt>max =</span> <span class=dv>1</span>)), <span class=dt>nrow =</span> <span class=dv>1000</span>, <span class=dt>ncol =</span> <span class=dv>1</span>)</a>
<a class=sourceLine id=cb8-17 data-line-number=17></a>
<a class=sourceLine id=cb8-18 data-line-number=18><span class=co># Train the model, iterating on the data in batches of 32 samples</span></a>
<a class=sourceLine id=cb8-19 data-line-number=19>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>fit</a></span>(data, labels, <span class=dt>epochs=</span><span class=dv>10</span>, <span class=dt>batch_size=</span><span class=dv>32</span>)</a></code></pre></div><p>Here’s a single-input model with 10 classes (categorical classification):</p><div class=sourceCode id=cb9><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb9-1 data-line-number=1><span class=co># create model</span></a>
<a class=sourceLine id=cb9-2 data-line-number=2>model &lt;-<span class=st> </span><span class=kw><a href=../../keras/reference/keras_model_sequential.html>keras_model_sequential</a></span>()</a>
<a class=sourceLine id=cb9-3 data-line-number=3></a>
<a class=sourceLine id=cb9-4 data-line-number=4><span class=co># define and compile the model</span></a>
<a class=sourceLine id=cb9-5 data-line-number=5>model <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb9-6 data-line-number=6><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>32</span>, <span class=dt>activation =</span> <span class=st>'relu'</span>, <span class=dt>input_shape =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>100</span>)) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb9-7 data-line-number=7><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>10</span>, <span class=dt>activation =</span> <span class=st>'softmax'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb9-8 data-line-number=8><span class=st>  </span><span class=kw><a href=../../keras/reference/reexports.html>compile</a></span>(</a>
<a class=sourceLine id=cb9-9 data-line-number=9>    <span class=dt>optimizer =</span> <span class=st>'rmsprop'</span>,</a>
<a class=sourceLine id=cb9-10 data-line-number=10>    <span class=dt>loss =</span> <span class=st>'categorical_crossentropy'</span>,</a>
<a class=sourceLine id=cb9-11 data-line-number=11>    <span class=dt>metrics =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=st>'accuracy'</span>)</a>
<a class=sourceLine id=cb9-12 data-line-number=12>  )</a>
<a class=sourceLine id=cb9-13 data-line-number=13></a>
<a class=sourceLine id=cb9-14 data-line-number=14><span class=co># Generate dummy data</span></a>
<a class=sourceLine id=cb9-15 data-line-number=15>data &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>1000</span><span class=op>*</span><span class=dv>100</span>), <span class=dt>nrow =</span> <span class=dv>1000</span>, <span class=dt>ncol =</span> <span class=dv>100</span>)</a>
<a class=sourceLine id=cb9-16 data-line-number=16>labels &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=kw><a href=https://rdrr.io/r/base/Round.html>round</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>1000</span>, <span class=dt>min =</span> <span class=dv>0</span>, <span class=dt>max =</span> <span class=dv>9</span>)), <span class=dt>nrow =</span> <span class=dv>1000</span>, <span class=dt>ncol =</span> <span class=dv>1</span>)</a>
<a class=sourceLine id=cb9-17 data-line-number=17></a>
<a class=sourceLine id=cb9-18 data-line-number=18><span class=co># Convert labels to categorical one-hot encoding</span></a>
<a class=sourceLine id=cb9-19 data-line-number=19>one_hot_labels &lt;-<span class=st> </span><span class=kw><a href=../../keras/reference/to_categorical.html>to_categorical</a></span>(labels, <span class=dt>num_classes =</span> <span class=dv>10</span>)</a>
<a class=sourceLine id=cb9-20 data-line-number=20></a>
<a class=sourceLine id=cb9-21 data-line-number=21><span class=co># Train the model, iterating on the data in batches of 32 samples</span></a>
<a class=sourceLine id=cb9-22 data-line-number=22>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>fit</a></span>(data, one_hot_labels, <span class=dt>epochs=</span><span class=dv>10</span>, <span class=dt>batch_size=</span><span class=dv>32</span>)</a></code></pre></div></div><div id=examples class="section level2"><h2>Examples</h2><p>Here are a few examples to get you started!</p><p>On the <a href=../examples/>examples</a> page you will also find example models for real datasets:</p><ul><li><p><a href=../examples/cifar10_cnn>CIFAR10 small images classification</a></p></li><li><p><a href=../examples/imdb_cnn_lstm>IMDB movie review sentiment classification</a></p></li><li><p><a href=../examples/reuters_mlp>Reuters newswires topic classification</a></p></li><li><p><a href=../examples/mnist_mlp>MNIST handwritten digits classification</a></p></li><li><p><a href=../examples/lstm_text_generation>Character-level text generation with LSTM</a></p></li></ul><p>Some additional examples are provided below.</p><div id=multilayer-perceptron-mlp-for-multi-class-softmax-classification class="section level3"><h3>Multilayer Perceptron (MLP) for multi-class softmax classification</h3><div class=sourceCode id=cb10><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb10-1 data-line-number=1><span class=kw><a href=https://rdrr.io/r/base/library.html>library</a></span>(keras)</a>
<a class=sourceLine id=cb10-2 data-line-number=2></a>
<a class=sourceLine id=cb10-3 data-line-number=3><span class=co># generate dummy data</span></a>
<a class=sourceLine id=cb10-4 data-line-number=4>x_train &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>1000</span><span class=op>*</span><span class=dv>20</span>), <span class=dt>nrow =</span> <span class=dv>1000</span>, <span class=dt>ncol =</span> <span class=dv>20</span>)</a>
<a class=sourceLine id=cb10-5 data-line-number=5></a>
<a class=sourceLine id=cb10-6 data-line-number=6>y_train &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>1000</span>, <span class=dt>min =</span> <span class=dv>0</span>, <span class=dt>max =</span> <span class=dv>9</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb10-7 data-line-number=7><span class=st>  </span><span class=kw><a href=https://rdrr.io/r/base/Round.html>round</a></span>() <span class=op>%&gt;%</span></a>
<a class=sourceLine id=cb10-8 data-line-number=8><span class=st>  </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=dt>nrow =</span> <span class=dv>1000</span>, <span class=dt>ncol =</span> <span class=dv>1</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb10-9 data-line-number=9><span class=st>  </span><span class=kw><a href=../../keras/reference/to_categorical.html>to_categorical</a></span>(<span class=dt>num_classes =</span> <span class=dv>10</span>)</a>
<a class=sourceLine id=cb10-10 data-line-number=10></a>
<a class=sourceLine id=cb10-11 data-line-number=11>x_test  &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>100</span><span class=op>*</span><span class=dv>20</span>), <span class=dt>nrow =</span> <span class=dv>100</span>, <span class=dt>ncol =</span> <span class=dv>20</span>)</a>
<a class=sourceLine id=cb10-12 data-line-number=12></a>
<a class=sourceLine id=cb10-13 data-line-number=13>y_test &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>100</span>, <span class=dt>min =</span> <span class=dv>0</span>, <span class=dt>max =</span> <span class=dv>9</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb10-14 data-line-number=14><span class=st>  </span><span class=kw><a href=https://rdrr.io/r/base/Round.html>round</a></span>() <span class=op>%&gt;%</span></a>
<a class=sourceLine id=cb10-15 data-line-number=15><span class=st>  </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=dt>nrow =</span> <span class=dv>100</span>, <span class=dt>ncol =</span> <span class=dv>1</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb10-16 data-line-number=16><span class=st>  </span><span class=kw><a href=../../keras/reference/to_categorical.html>to_categorical</a></span>(<span class=dt>num_classes =</span> <span class=dv>10</span>)</a>
<a class=sourceLine id=cb10-17 data-line-number=17></a>
<a class=sourceLine id=cb10-18 data-line-number=18><span class=co># create model</span></a>
<a class=sourceLine id=cb10-19 data-line-number=19>model &lt;-<span class=st> </span><span class=kw><a href=../../keras/reference/keras_model_sequential.html>keras_model_sequential</a></span>()</a>
<a class=sourceLine id=cb10-20 data-line-number=20></a>
<a class=sourceLine id=cb10-21 data-line-number=21><span class=co># define and compile the model</span></a>
<a class=sourceLine id=cb10-22 data-line-number=22>model <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb10-23 data-line-number=23><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>64</span>, <span class=dt>activation =</span> <span class=st>'relu'</span>, <span class=dt>input_shape =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>20</span>)) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb10-24 data-line-number=24><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dropout.html>layer_dropout</a></span>(<span class=dt>rate =</span> <span class=fl>0.5</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb10-25 data-line-number=25><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>64</span>, <span class=dt>activation =</span> <span class=st>'relu'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb10-26 data-line-number=26><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dropout.html>layer_dropout</a></span>(<span class=dt>rate =</span> <span class=fl>0.5</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb10-27 data-line-number=27><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>10</span>, <span class=dt>activation =</span> <span class=st>'softmax'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb10-28 data-line-number=28><span class=st>  </span><span class=kw><a href=../../keras/reference/reexports.html>compile</a></span>(</a>
<a class=sourceLine id=cb10-29 data-line-number=29>    <span class=dt>loss =</span> <span class=st>'categorical_crossentropy'</span>,</a>
<a class=sourceLine id=cb10-30 data-line-number=30>    <span class=dt>optimizer =</span> <span class=kw><a href=../../keras/reference/optimizer_sgd.html>optimizer_sgd</a></span>(<span class=dt>lr =</span> <span class=fl>0.01</span>, <span class=dt>decay =</span> <span class=fl>1e-6</span>, <span class=dt>momentum =</span> <span class=fl>0.9</span>, <span class=dt>nesterov =</span> <span class=ot>TRUE</span>),</a>
<a class=sourceLine id=cb10-31 data-line-number=31>    <span class=dt>metrics =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=st>'accuracy'</span>)     </a>
<a class=sourceLine id=cb10-32 data-line-number=32>  )</a>
<a class=sourceLine id=cb10-33 data-line-number=33></a>
<a class=sourceLine id=cb10-34 data-line-number=34><span class=co># train</span></a>
<a class=sourceLine id=cb10-35 data-line-number=35>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>fit</a></span>(x_train, y_train, <span class=dt>epochs =</span> <span class=dv>20</span>, <span class=dt>batch_size =</span> <span class=dv>128</span>)</a>
<a class=sourceLine id=cb10-36 data-line-number=36></a>
<a class=sourceLine id=cb10-37 data-line-number=37><span class=co># evaluate</span></a>
<a class=sourceLine id=cb10-38 data-line-number=38>score &lt;-<span class=st> </span>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>evaluate</a></span>(x_test, y_test, <span class=dt>batch_size =</span> <span class=dv>128</span>)</a></code></pre></div></div><div id=mlp-for-binary-classification class="section level3"><h3>MLP for binary classification</h3><div class=sourceCode id=cb11><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb11-1 data-line-number=1><span class=kw><a href=https://rdrr.io/r/base/library.html>library</a></span>(keras)</a>
<a class=sourceLine id=cb11-2 data-line-number=2></a>
<a class=sourceLine id=cb11-3 data-line-number=3><span class=co># generate dummy data</span></a>
<a class=sourceLine id=cb11-4 data-line-number=4>x_train &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>1000</span><span class=op>*</span><span class=dv>20</span>), <span class=dt>nrow =</span> <span class=dv>1000</span>, <span class=dt>ncol =</span> <span class=dv>20</span>)</a>
<a class=sourceLine id=cb11-5 data-line-number=5>y_train &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=kw><a href=https://rdrr.io/r/base/Round.html>round</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>1000</span>, <span class=dt>min =</span> <span class=dv>0</span>, <span class=dt>max =</span> <span class=dv>1</span>)), <span class=dt>nrow =</span> <span class=dv>1000</span>, <span class=dt>ncol =</span> <span class=dv>1</span>)</a>
<a class=sourceLine id=cb11-6 data-line-number=6>x_test &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>100</span><span class=op>*</span><span class=dv>20</span>), <span class=dt>nrow =</span> <span class=dv>100</span>, <span class=dt>ncol =</span> <span class=dv>20</span>)</a>
<a class=sourceLine id=cb11-7 data-line-number=7>y_test &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=kw><a href=https://rdrr.io/r/base/Round.html>round</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>100</span>, <span class=dt>min =</span> <span class=dv>0</span>, <span class=dt>max =</span> <span class=dv>1</span>)), <span class=dt>nrow =</span> <span class=dv>100</span>, <span class=dt>ncol =</span> <span class=dv>1</span>)</a>
<a class=sourceLine id=cb11-8 data-line-number=8></a>
<a class=sourceLine id=cb11-9 data-line-number=9><span class=co># create model</span></a>
<a class=sourceLine id=cb11-10 data-line-number=10>model &lt;-<span class=st> </span><span class=kw><a href=../../keras/reference/keras_model_sequential.html>keras_model_sequential</a></span>()</a>
<a class=sourceLine id=cb11-11 data-line-number=11></a>
<a class=sourceLine id=cb11-12 data-line-number=12><span class=co># define and compile the model</span></a>
<a class=sourceLine id=cb11-13 data-line-number=13>model <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb11-14 data-line-number=14><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>64</span>, <span class=dt>activation =</span> <span class=st>'relu'</span>, <span class=dt>input_shape =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>20</span>)) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb11-15 data-line-number=15><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dropout.html>layer_dropout</a></span>(<span class=dt>rate =</span> <span class=fl>0.5</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb11-16 data-line-number=16><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>64</span>, <span class=dt>activation =</span> <span class=st>'relu'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb11-17 data-line-number=17><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dropout.html>layer_dropout</a></span>(<span class=dt>rate =</span> <span class=fl>0.5</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb11-18 data-line-number=18><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>1</span>, <span class=dt>activation =</span> <span class=st>'sigmoid'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb11-19 data-line-number=19><span class=st>  </span><span class=kw><a href=../../keras/reference/reexports.html>compile</a></span>(</a>
<a class=sourceLine id=cb11-20 data-line-number=20>    <span class=dt>loss =</span> <span class=st>'binary_crossentropy'</span>,</a>
<a class=sourceLine id=cb11-21 data-line-number=21>    <span class=dt>optimizer =</span> <span class=st>'rmsprop'</span>,</a>
<a class=sourceLine id=cb11-22 data-line-number=22>    <span class=dt>metrics =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=st>'accuracy'</span>)</a>
<a class=sourceLine id=cb11-23 data-line-number=23>  )</a>
<a class=sourceLine id=cb11-24 data-line-number=24></a>
<a class=sourceLine id=cb11-25 data-line-number=25><span class=co># train </span></a>
<a class=sourceLine id=cb11-26 data-line-number=26>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>fit</a></span>(x_train, y_train, <span class=dt>epochs =</span> <span class=dv>20</span>, <span class=dt>batch_size =</span> <span class=dv>128</span>)</a>
<a class=sourceLine id=cb11-27 data-line-number=27></a>
<a class=sourceLine id=cb11-28 data-line-number=28><span class=co># evaluate</span></a>
<a class=sourceLine id=cb11-29 data-line-number=29>score =<span class=st> </span>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>evaluate</a></span>(x_test, y_test, <span class=dt>batch_size=</span><span class=dv>128</span>)</a></code></pre></div></div><div id=vgg-like-convnet class="section level3"><h3>VGG-like convnet</h3><div class=sourceCode id=cb12><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb12-1 data-line-number=1><span class=kw><a href=https://rdrr.io/r/base/library.html>library</a></span>(keras)</a>
<a class=sourceLine id=cb12-2 data-line-number=2></a>
<a class=sourceLine id=cb12-3 data-line-number=3><span class=co># generate dummy data</span></a>
<a class=sourceLine id=cb12-4 data-line-number=4>x_train &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/array.html>array</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>100</span> <span class=op>*</span><span class=st> </span><span class=dv>100</span> <span class=op>*</span><span class=st> </span><span class=dv>100</span> <span class=op>*</span><span class=st> </span><span class=dv>3</span>), <span class=dt>dim =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>100</span>, <span class=dv>100</span>, <span class=dv>100</span>, <span class=dv>3</span>))</a>
<a class=sourceLine id=cb12-5 data-line-number=5></a>
<a class=sourceLine id=cb12-6 data-line-number=6>y_train &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>100</span>, <span class=dt>min =</span> <span class=dv>0</span>, <span class=dt>max =</span> <span class=dv>9</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-7 data-line-number=7><span class=st>  </span><span class=kw><a href=https://rdrr.io/r/base/Round.html>round</a></span>() <span class=op>%&gt;%</span></a>
<a class=sourceLine id=cb12-8 data-line-number=8><span class=st>  </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=dt>nrow =</span> <span class=dv>100</span>, <span class=dt>ncol =</span> <span class=dv>1</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-9 data-line-number=9><span class=st>  </span><span class=kw><a href=../../keras/reference/to_categorical.html>to_categorical</a></span>(<span class=dt>num_classes =</span> <span class=dv>10</span>)</a>
<a class=sourceLine id=cb12-10 data-line-number=10></a>
<a class=sourceLine id=cb12-11 data-line-number=11>x_test &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/array.html>array</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>20</span> <span class=op>*</span><span class=st> </span><span class=dv>100</span> <span class=op>*</span><span class=st> </span><span class=dv>100</span> <span class=op>*</span><span class=st> </span><span class=dv>3</span>), <span class=dt>dim =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>20</span>, <span class=dv>100</span>, <span class=dv>100</span>, <span class=dv>3</span>))</a>
<a class=sourceLine id=cb12-12 data-line-number=12></a>
<a class=sourceLine id=cb12-13 data-line-number=13>y_test &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>20</span>, <span class=dt>min =</span> <span class=dv>0</span>, <span class=dt>max =</span> <span class=dv>9</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-14 data-line-number=14><span class=st>  </span><span class=kw><a href=https://rdrr.io/r/base/Round.html>round</a></span>() <span class=op>%&gt;%</span></a>
<a class=sourceLine id=cb12-15 data-line-number=15><span class=st>  </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=dt>nrow =</span> <span class=dv>20</span>, <span class=dt>ncol =</span> <span class=dv>1</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-16 data-line-number=16><span class=st>  </span><span class=kw><a href=../../keras/reference/to_categorical.html>to_categorical</a></span>(<span class=dt>num_classes =</span> <span class=dv>10</span>)</a>
<a class=sourceLine id=cb12-17 data-line-number=17></a>
<a class=sourceLine id=cb12-18 data-line-number=18><span class=co># create model</span></a>
<a class=sourceLine id=cb12-19 data-line-number=19>model &lt;-<span class=st> </span><span class=kw><a href=../../keras/reference/keras_model_sequential.html>keras_model_sequential</a></span>()</a>
<a class=sourceLine id=cb12-20 data-line-number=20></a>
<a class=sourceLine id=cb12-21 data-line-number=21><span class=co># define and compile model</span></a>
<a class=sourceLine id=cb12-22 data-line-number=22><span class=co># input: 100x100 images with 3 channels -&gt; (100, 100, 3) tensors.</span></a>
<a class=sourceLine id=cb12-23 data-line-number=23><span class=co># this applies 32 convolution filters of size 3x3 each.</span></a>
<a class=sourceLine id=cb12-24 data-line-number=24>model <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-25 data-line-number=25><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_conv_2d.html>layer_conv_2d</a></span>(<span class=dt>filters =</span> <span class=dv>32</span>, <span class=dt>kernel_size =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>3</span>,<span class=dv>3</span>), <span class=dt>activation =</span> <span class=st>'relu'</span>, </a>
<a class=sourceLine id=cb12-26 data-line-number=26>                <span class=dt>input_shape =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>100</span>,<span class=dv>100</span>,<span class=dv>3</span>)) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-27 data-line-number=27><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_conv_2d.html>layer_conv_2d</a></span>(<span class=dt>filters =</span> <span class=dv>32</span>, <span class=dt>kernel_size =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>3</span>,<span class=dv>3</span>), <span class=dt>activation =</span> <span class=st>'relu'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-28 data-line-number=28><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_max_pooling_2d.html>layer_max_pooling_2d</a></span>(<span class=dt>pool_size =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>2</span>,<span class=dv>2</span>)) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-29 data-line-number=29><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dropout.html>layer_dropout</a></span>(<span class=dt>rate =</span> <span class=fl>0.25</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-30 data-line-number=30><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_conv_2d.html>layer_conv_2d</a></span>(<span class=dt>filters =</span> <span class=dv>64</span>, <span class=dt>kernel_size =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>3</span>,<span class=dv>3</span>), <span class=dt>activation =</span> <span class=st>'relu'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-31 data-line-number=31><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_conv_2d.html>layer_conv_2d</a></span>(<span class=dt>filters =</span> <span class=dv>64</span>, <span class=dt>kernel_size =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>3</span>,<span class=dv>3</span>), <span class=dt>activation =</span> <span class=st>'relu'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-32 data-line-number=32><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_max_pooling_2d.html>layer_max_pooling_2d</a></span>(<span class=dt>pool_size =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>2</span>,<span class=dv>2</span>)) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-33 data-line-number=33><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dropout.html>layer_dropout</a></span>(<span class=dt>rate =</span> <span class=fl>0.25</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-34 data-line-number=34><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_flatten.html>layer_flatten</a></span>() <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-35 data-line-number=35><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>256</span>, <span class=dt>activation =</span> <span class=st>'relu'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-36 data-line-number=36><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dropout.html>layer_dropout</a></span>(<span class=dt>rate =</span> <span class=fl>0.25</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-37 data-line-number=37><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>10</span>, <span class=dt>activation =</span> <span class=st>'softmax'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-38 data-line-number=38><span class=st>  </span><span class=kw><a href=../../keras/reference/reexports.html>compile</a></span>(</a>
<a class=sourceLine id=cb12-39 data-line-number=39>    <span class=dt>loss =</span> <span class=st>'categorical_crossentropy'</span>, </a>
<a class=sourceLine id=cb12-40 data-line-number=40>    <span class=dt>optimizer =</span> <span class=kw><a href=../../keras/reference/optimizer_sgd.html>optimizer_sgd</a></span>(<span class=dt>lr =</span> <span class=fl>0.01</span>, <span class=dt>decay =</span> <span class=fl>1e-6</span>, <span class=dt>momentum =</span> <span class=fl>0.9</span>, <span class=dt>nesterov =</span> <span class=ot>TRUE</span>)</a>
<a class=sourceLine id=cb12-41 data-line-number=41>  )</a>
<a class=sourceLine id=cb12-42 data-line-number=42>  </a>
<a class=sourceLine id=cb12-43 data-line-number=43><span class=co># train</span></a>
<a class=sourceLine id=cb12-44 data-line-number=44>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>fit</a></span>(x_train, y_train, <span class=dt>batch_size =</span> <span class=dv>32</span>, <span class=dt>epochs =</span> <span class=dv>10</span>)</a>
<a class=sourceLine id=cb12-45 data-line-number=45></a>
<a class=sourceLine id=cb12-46 data-line-number=46><span class=co># evaluate</span></a>
<a class=sourceLine id=cb12-47 data-line-number=47>score &lt;-<span class=st> </span>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>evaluate</a></span>(x_test, y_test, <span class=dt>batch_size =</span> <span class=dv>32</span>)</a></code></pre></div></div><div id=sequence-classification-with-lstm class="section level3"><h3>Sequence classification with LSTM</h3><div class=sourceCode id=cb13><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb13-1 data-line-number=1>model &lt;-<span class=st> </span><span class=kw><a href=../../keras/reference/keras_model_sequential.html>keras_model_sequential</a></span>() </a>
<a class=sourceLine id=cb13-2 data-line-number=2>model <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb13-3 data-line-number=3><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_embedding.html>layer_embedding</a></span>(<span class=dt>input_dim =</span> max_features, output_dim <span class=op>-</span><span class=st> </span><span class=dv>256</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb13-4 data-line-number=4><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_lstm.html>layer_lstm</a></span>(<span class=dt>units =</span> <span class=dv>128</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb13-5 data-line-number=5><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dropout.html>layer_dropout</a></span>(<span class=dt>rate =</span> <span class=fl>0.5</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb13-6 data-line-number=6><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>1</span>, <span class=dt>activation =</span> <span class=st>'sigmoid'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb13-7 data-line-number=7><span class=st>  </span><span class=kw><a href=../../keras/reference/reexports.html>compile</a></span>(</a>
<a class=sourceLine id=cb13-8 data-line-number=8>    <span class=dt>loss =</span> <span class=st>'binary_crossentropy'</span>,</a>
<a class=sourceLine id=cb13-9 data-line-number=9>    <span class=dt>optimizer =</span> <span class=st>'rmsprop'</span>,</a>
<a class=sourceLine id=cb13-10 data-line-number=10>    <span class=dt>metrics =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=st>'accuracy'</span>)</a>
<a class=sourceLine id=cb13-11 data-line-number=11>  )</a>
<a class=sourceLine id=cb13-12 data-line-number=12></a>
<a class=sourceLine id=cb13-13 data-line-number=13>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>fit</a></span>(x_train, y_train, <span class=dt>batch_size =</span> <span class=dv>16</span>, <span class=dt>epochs =</span> <span class=dv>10</span>)</a>
<a class=sourceLine id=cb13-14 data-line-number=14>score &lt;-<span class=st> </span>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>evaluate</a></span>(x_test, y_test, <span class=dt>batch_size =</span> <span class=dv>16</span>)</a></code></pre></div></div><div id=sequence-classification-with-1d-convolutions class="section level3"><h3>Sequence classification with 1D convolutions:</h3><div class=sourceCode id=cb14><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb14-1 data-line-number=1>model &lt;-<span class=st> </span><span class=kw><a href=../../keras/reference/keras_model_sequential.html>keras_model_sequential</a></span>()</a>
<a class=sourceLine id=cb14-2 data-line-number=2>model <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb14-3 data-line-number=3><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_conv_1d.html>layer_conv_1d</a></span>(<span class=dt>filters =</span> <span class=dv>64</span>, <span class=dt>kernel_size =</span> <span class=dv>3</span>, <span class=dt>activation =</span> <span class=st>'relu'</span>,</a>
<a class=sourceLine id=cb14-4 data-line-number=4>                <span class=dt>input_shape =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(seq_length, <span class=dv>100</span>)) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb14-5 data-line-number=5><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_conv_1d.html>layer_conv_1d</a></span>(<span class=dt>filters =</span> <span class=dv>64</span>, <span class=dt>kernel_size =</span> <span class=dv>3</span>, <span class=dt>activation =</span> <span class=st>'relu'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb14-6 data-line-number=6><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_max_pooling_1d.html>layer_max_pooling_1d</a></span>(<span class=dt>pool_size =</span> <span class=dv>3</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb14-7 data-line-number=7><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_conv_1d.html>layer_conv_1d</a></span>(<span class=dt>filters =</span> <span class=dv>128</span>, <span class=dt>kernel_size =</span> <span class=dv>3</span>, <span class=dt>activation =</span> <span class=st>'relu'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb14-8 data-line-number=8><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_conv_1d.html>layer_conv_1d</a></span>(<span class=dt>filters =</span> <span class=dv>128</span>, <span class=dt>kernel_size =</span> <span class=dv>3</span>, <span class=dt>activation =</span> <span class=st>'relu'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb14-9 data-line-number=9><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_global_average_pooling_1d.html>layer_global_average_pooling_1d</a></span>() <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb14-10 data-line-number=10><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dropout.html>layer_dropout</a></span>(<span class=dt>rate =</span> <span class=fl>0.5</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb14-11 data-line-number=11><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>1</span>, <span class=dt>activation =</span> <span class=st>'sigmoid'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb14-12 data-line-number=12><span class=st>  </span><span class=kw><a href=../../keras/reference/reexports.html>compile</a></span>(</a>
<a class=sourceLine id=cb14-13 data-line-number=13>    <span class=dt>loss =</span> <span class=st>'binary_crossentropy'</span>,</a>
<a class=sourceLine id=cb14-14 data-line-number=14>    <span class=dt>optimizer =</span> <span class=st>'rmsprop'</span>,</a>
<a class=sourceLine id=cb14-15 data-line-number=15>    <span class=dt>metrics =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=st>'accuracy'</span>)</a>
<a class=sourceLine id=cb14-16 data-line-number=16>  )</a>
<a class=sourceLine id=cb14-17 data-line-number=17></a>
<a class=sourceLine id=cb14-18 data-line-number=18>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>fit</a></span>(x_train, y_train, <span class=dt>batch_size =</span> <span class=dv>16</span>, <span class=dt>epochs =</span> <span class=dv>10</span>)</a>
<a class=sourceLine id=cb14-19 data-line-number=19>score &lt;-<span class=st> </span>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>evaluate</a></span>(x_test, y_test, <span class=dt>batch_size =</span> <span class=dv>16</span>)</a></code></pre></div></div><div id=stacked-lstm-for-sequence-classification class="section level3"><h3>Stacked LSTM for sequence classification</h3><p>In this model, we stack 3 LSTM layers on top of each other,
making the model capable of learning higher-level temporal representations.</p><p>The first two LSTMs return their full output sequences, but the last one only returns
the last step in its output sequence, thus dropping the temporal dimension
(i.e. converting the input sequence into a single vector).</p><p><img src=../images/regular_stacked_lstm.png alt="stacked LSTM" style=width:300px></p><div class=sourceCode id=cb15><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb15-1 data-line-number=1><span class=kw><a href=https://rdrr.io/r/base/library.html>library</a></span>(keras)</a>
<a class=sourceLine id=cb15-2 data-line-number=2></a>
<a class=sourceLine id=cb15-3 data-line-number=3><span class=co># constants</span></a>
<a class=sourceLine id=cb15-4 data-line-number=4>data_dim &lt;-<span class=st> </span><span class=dv>16</span></a>
<a class=sourceLine id=cb15-5 data-line-number=5>timesteps &lt;-<span class=st> </span><span class=dv>8</span></a>
<a class=sourceLine id=cb15-6 data-line-number=6>num_classes &lt;-<span class=st> </span><span class=dv>10</span></a>
<a class=sourceLine id=cb15-7 data-line-number=7></a>
<a class=sourceLine id=cb15-8 data-line-number=8><span class=co># define and compile model</span></a>
<a class=sourceLine id=cb15-9 data-line-number=9><span class=co># expected input data shape: (batch_size, timesteps, data_dim)</span></a>
<a class=sourceLine id=cb15-10 data-line-number=10>model &lt;-<span class=st> </span><span class=kw><a href=../../keras/reference/keras_model_sequential.html>keras_model_sequential</a></span>() </a>
<a class=sourceLine id=cb15-11 data-line-number=11>model <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb15-12 data-line-number=12><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_lstm.html>layer_lstm</a></span>(<span class=dt>units =</span> <span class=dv>32</span>, <span class=dt>return_sequences =</span> <span class=ot>TRUE</span>, <span class=dt>input_shape =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(timesteps, data_dim)) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb15-13 data-line-number=13><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_lstm.html>layer_lstm</a></span>(<span class=dt>units =</span> <span class=dv>32</span>, <span class=dt>return_sequences =</span> <span class=ot>TRUE</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb15-14 data-line-number=14><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_lstm.html>layer_lstm</a></span>(<span class=dt>units =</span> <span class=dv>32</span>) <span class=op>%&gt;%</span><span class=st> </span><span class=co># return a single vector dimension 32</span></a>
<a class=sourceLine id=cb15-15 data-line-number=15><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>10</span>, <span class=dt>activation =</span> <span class=st>'softmax'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb15-16 data-line-number=16><span class=st>  </span><span class=kw><a href=../../keras/reference/reexports.html>compile</a></span>(</a>
<a class=sourceLine id=cb15-17 data-line-number=17>    <span class=dt>loss =</span> <span class=st>'categorical_crossentropy'</span>,</a>
<a class=sourceLine id=cb15-18 data-line-number=18>    <span class=dt>optimizer =</span> <span class=st>'rmsprop'</span>,</a>
<a class=sourceLine id=cb15-19 data-line-number=19>    <span class=dt>metrics =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=st>'accuracy'</span>)</a>
<a class=sourceLine id=cb15-20 data-line-number=20>  )</a>
<a class=sourceLine id=cb15-21 data-line-number=21>  </a>
<a class=sourceLine id=cb15-22 data-line-number=22><span class=co># generate dummy training data</span></a>
<a class=sourceLine id=cb15-23 data-line-number=23>x_train &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/array.html>array</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>1000</span> <span class=op>*</span><span class=st> </span>timesteps <span class=op>*</span><span class=st> </span>data_dim), <span class=dt>dim =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>1000</span>, timesteps, data_dim))</a>
<a class=sourceLine id=cb15-24 data-line-number=24>y_train &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>1000</span> <span class=op>*</span><span class=st> </span>num_classes), <span class=dt>nrow =</span> <span class=dv>1000</span>, <span class=dt>ncol =</span> num_classes)</a>
<a class=sourceLine id=cb15-25 data-line-number=25></a>
<a class=sourceLine id=cb15-26 data-line-number=26><span class=co># generate dummy validation data</span></a>
<a class=sourceLine id=cb15-27 data-line-number=27>x_val &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/array.html>array</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>100</span> <span class=op>*</span><span class=st> </span>timesteps <span class=op>*</span><span class=st> </span>data_dim), <span class=dt>dim =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>100</span>, timesteps, data_dim))</a>
<a class=sourceLine id=cb15-28 data-line-number=28>y_val &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>(<span class=dv>100</span> <span class=op>*</span><span class=st> </span>num_classes), <span class=dt>nrow =</span> <span class=dv>100</span>, <span class=dt>ncol =</span> num_classes)</a>
<a class=sourceLine id=cb15-29 data-line-number=29></a>
<a class=sourceLine id=cb15-30 data-line-number=30><span class=co># train</span></a>
<a class=sourceLine id=cb15-31 data-line-number=31>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>fit</a></span>( </a>
<a class=sourceLine id=cb15-32 data-line-number=32>  x_train, y_train, <span class=dt>batch_size =</span> <span class=dv>64</span>, <span class=dt>epochs =</span> <span class=dv>5</span>, <span class=dt>validation_data =</span> <span class=kw><a href=https://rdrr.io/r/base/list.html>list</a></span>(x_val, y_val)</a>
<a class=sourceLine id=cb15-33 data-line-number=33>)</a></code></pre></div></div><div id=same-stacked-lstm-model-rendered-stateful class="section level3"><h3>Same stacked LSTM model, rendered “stateful”</h3><p>A stateful recurrent model is one for which the internal states (memories) obtained after processing a batch of samples are reused as initial states for the samples of the next batch. This allows to process longer sequences while keeping computational complexity manageable.</p><p><a href=../faq#how-can-i-use-stateful-rnns>You can read more about stateful RNNs in the FAQ.</a></p><div class=sourceCode id=cb16><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb16-1 data-line-number=1><span class=kw><a href=https://rdrr.io/r/base/library.html>library</a></span>(keras)</a>
<a class=sourceLine id=cb16-2 data-line-number=2></a>
<a class=sourceLine id=cb16-3 data-line-number=3><span class=co># constants</span></a>
<a class=sourceLine id=cb16-4 data-line-number=4>data_dim &lt;-<span class=st> </span><span class=dv>16</span></a>
<a class=sourceLine id=cb16-5 data-line-number=5>timesteps &lt;-<span class=st> </span><span class=dv>8</span></a>
<a class=sourceLine id=cb16-6 data-line-number=6>num_classes &lt;-<span class=st> </span><span class=dv>10</span></a>
<a class=sourceLine id=cb16-7 data-line-number=7>batch_size &lt;-<span class=st> </span><span class=dv>32</span></a>
<a class=sourceLine id=cb16-8 data-line-number=8></a>
<a class=sourceLine id=cb16-9 data-line-number=9><span class=co># define and compile model</span></a>
<a class=sourceLine id=cb16-10 data-line-number=10><span class=co># Expected input batch shape: (batch_size, timesteps, data_dim)</span></a>
<a class=sourceLine id=cb16-11 data-line-number=11><span class=co># Note that we have to provide the full batch_input_shape since the network is stateful.</span></a>
<a class=sourceLine id=cb16-12 data-line-number=12><span class=co># the sample of index i in batch k is the follow-up for the sample i in batch k-1.</span></a>
<a class=sourceLine id=cb16-13 data-line-number=13>model &lt;-<span class=st> </span><span class=kw><a href=../../keras/reference/keras_model_sequential.html>keras_model_sequential</a></span>()</a>
<a class=sourceLine id=cb16-14 data-line-number=14>model <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb16-15 data-line-number=15><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_lstm.html>layer_lstm</a></span>(<span class=dt>units =</span> <span class=dv>32</span>, <span class=dt>return_sequences =</span> <span class=ot>TRUE</span>, <span class=dt>stateful =</span> <span class=ot>TRUE</span>,</a>
<a class=sourceLine id=cb16-16 data-line-number=16>             <span class=dt>batch_input_shape =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(batch_size, timesteps, data_dim)) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb16-17 data-line-number=17><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_lstm.html>layer_lstm</a></span>(<span class=dt>units =</span> <span class=dv>32</span>, <span class=dt>return_sequences =</span> <span class=ot>TRUE</span>, <span class=dt>stateful =</span> <span class=ot>TRUE</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb16-18 data-line-number=18><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_lstm.html>layer_lstm</a></span>(<span class=dt>units =</span> <span class=dv>32</span>, <span class=dt>stateful =</span> <span class=ot>TRUE</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb16-19 data-line-number=19><span class=st>  </span><span class=kw><a href=../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>10</span>, <span class=dt>activation =</span> <span class=st>'softmax'</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb16-20 data-line-number=20><span class=st>  </span><span class=kw><a href=../../keras/reference/reexports.html>compile</a></span>(</a>
<a class=sourceLine id=cb16-21 data-line-number=21>    <span class=dt>loss =</span> <span class=st>'categorical_crossentropy'</span>,</a>
<a class=sourceLine id=cb16-22 data-line-number=22>    <span class=dt>optimizer =</span> <span class=st>'rmsprop'</span>,</a>
<a class=sourceLine id=cb16-23 data-line-number=23>    <span class=dt>metrics =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=st>'accuracy'</span>)</a>
<a class=sourceLine id=cb16-24 data-line-number=24>  )</a>
<a class=sourceLine id=cb16-25 data-line-number=25>  </a>
<a class=sourceLine id=cb16-26 data-line-number=26><span class=co># generate dummy training data</span></a>
<a class=sourceLine id=cb16-27 data-line-number=27>x_train &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/array.html>array</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>( (batch_size <span class=op>*</span><span class=st> </span><span class=dv>10</span>) <span class=op>*</span><span class=st> </span>timesteps <span class=op>*</span><span class=st> </span>data_dim), </a>
<a class=sourceLine id=cb16-28 data-line-number=28>                 <span class=dt>dim =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(batch_size <span class=op>*</span><span class=st> </span><span class=dv>10</span>, timesteps, data_dim))</a>
<a class=sourceLine id=cb16-29 data-line-number=29>y_train &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>( (batch_size <span class=op>*</span><span class=st> </span><span class=dv>10</span>) <span class=op>*</span><span class=st> </span>num_classes), </a>
<a class=sourceLine id=cb16-30 data-line-number=30>                  <span class=dt>nrow =</span> batch_size <span class=op>*</span><span class=st> </span><span class=dv>10</span>, <span class=dt>ncol =</span> num_classes)</a>
<a class=sourceLine id=cb16-31 data-line-number=31></a>
<a class=sourceLine id=cb16-32 data-line-number=32><span class=co># generate dummy validation data</span></a>
<a class=sourceLine id=cb16-33 data-line-number=33>x_val &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/array.html>array</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>( (batch_size <span class=op>*</span><span class=st> </span><span class=dv>3</span>) <span class=op>*</span><span class=st> </span>timesteps <span class=op>*</span><span class=st> </span>data_dim), </a>
<a class=sourceLine id=cb16-34 data-line-number=34>               <span class=dt>dim =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(batch_size <span class=op>*</span><span class=st> </span><span class=dv>3</span>, timesteps, data_dim))</a>
<a class=sourceLine id=cb16-35 data-line-number=35>y_val &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(<span class=kw><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span>( (batch_size <span class=op>*</span><span class=st> </span><span class=dv>3</span>) <span class=op>*</span><span class=st> </span>num_classes), </a>
<a class=sourceLine id=cb16-36 data-line-number=36>                <span class=dt>nrow =</span> batch_size <span class=op>*</span><span class=st> </span><span class=dv>3</span>, <span class=dt>ncol =</span> num_classes)</a>
<a class=sourceLine id=cb16-37 data-line-number=37></a>
<a class=sourceLine id=cb16-38 data-line-number=38><span class=co># train</span></a>
<a class=sourceLine id=cb16-39 data-line-number=39>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../keras/reference/reexports.html>fit</a></span>( </a>
<a class=sourceLine id=cb16-40 data-line-number=40>  x_train, </a>
<a class=sourceLine id=cb16-41 data-line-number=41>  y_train, </a>
<a class=sourceLine id=cb16-42 data-line-number=42>  <span class=dt>batch_size =</span> batch_size, </a>
<a class=sourceLine id=cb16-43 data-line-number=43>  <span class=dt>epochs =</span> <span class=dv>5</span>, </a>
<a class=sourceLine id=cb16-44 data-line-number=44>  <span class=dt>shuffle =</span> <span class=ot>FALSE</span>,</a>
<a class=sourceLine id=cb16-45 data-line-number=45>  <span class=dt>validation_data =</span> <span class=kw><a href=https://rdrr.io/r/base/list.html>list</a></span>(x_val, y_val)</a>
<a class=sourceLine id=cb16-46 data-line-number=46>)</a></code></pre></div></div></div></div></div></div><footer>Copyright © 2015-2019 The TensorFlow Authors and RStudio, Inc.
<script type=text/javascript>(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');_st('install','Ne8tbLfE121Pkj3xMr_G','2.0.0');</script></footer></div></div></body></html>