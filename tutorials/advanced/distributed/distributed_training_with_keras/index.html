<!doctype html><html><head><script>theBaseUrl=location.origin+"/";</script><meta charset=utf-8><meta name=viewport content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1"><title>Distributed training with Keras</title><meta name=generator content="Hugo 0.58.3"><meta name=description content="Documentation for the TensorFlow for R interface"><link rel=canonical href=/tutorials/advanced/distributed/distributed_training_with_keras/><meta name=author content="J.J. Allaire"><meta property=og:url content=/tutorials/advanced/distributed/distributed_training_with_keras/><meta property=og:title content="TensorFlow for R"><meta name=apple-mobile-web-app-title content="TensorFlow for R"><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=black-translucent><style>@font-face{font-family:icon;src:url(fonts/icon.eot?52m981);src:url(fonts/icon.eot?#iefix52m981) format('embedded-opentype'),url(fonts/icon.woff?52m981) format('woff'),url(fonts/icon.ttf?52m981) format('truetype'),url(fonts/icon.svg?52m981#icon) format('svg');font-weight:400;font-style:normal}</style><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/site-styles.css><script src=/js/vendor.js></script><script src=/js/app.js></script><link rel="shortcut icon" href=/images/favicon.png><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script></head><body><div class=single-page><nav data-gumshoe-header aria-label=Header id=header class=top-menu><div class=left><a href=/ data-parenturl class="top-menu-item site-title">TensorFlow for R</a>
<span class=logo-from>from</span>
<a href=/><div id=logo class=logo></div></a></div><div class=right><div class=top-menu-items id=top-menu-items><a href=/ data-parenturl=/ class=top-menu-item>Home</a>
<a href=/installation/ data-parenturl=/installation/ class=top-menu-item>Installation</a>
<a href=/tutorials/ data-parenturl=/tutorials/ class=top-menu-item>Tutorials</a>
<a href=/guide/ data-parenturl=/guide/ class=top-menu-item>Guide</a>
<a href=/deploy/ data-parenturl=/deploy/ class=top-menu-item>Deploy</a>
<a href=/tools/ data-parenturl=/tools/ class=top-menu-item>Tools</a>
<a href=/reference/keras data-parenturl=/reference/keras class=top-menu-item>API</a>
<a href=/learn/resources/ data-parenturl=/learn/resources/ class=top-menu-item>Learn</a>
<a href=/blog.html data-parenturl=/blog.html class=top-menu-item>Blog</a></div><a href=https://github.com/rstudio/keras class=github-logo><i class="fa fa-lg fa-github" aria-hidden=true></i></a><div class=search-button><i class="fa fa-lg fa-search"></i></div></div></nav><nav aria-label=Header id=mobile-header><a href=/>TensorFlow for R</a><div class=right><a href=https://github.com/rstudio/keras class=github-logo><i class="fa fa-lg fa-github" aria-hidden=true></i></a><div class=hamburger><i class="fa fa-lg fa-bars" aria-hidden=true></i></div></div></nav><div id=mobile-menu-container><ul id=mobile-menu><li><a href=/>Home</a></li><ul></ul><li><a href=/installation/>Installation</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/installation/>Installing TensorFlow</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/installation/>Quick start</a></li><li><a href=/installation/custom/>Custom Installation</a></li></ul><li><a href=/installation/gpu>Using a GPU</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/installation/gpu/>Overview</a></li><li><a href=/installation/gpu/local_gpu/>Local GPU</a></li><li><a href=/installation/gpu/cloud_server_gpu/>Cloud Server</a></li><li><a href=/installation/gpu/cloud_desktop_gpu/>Cloud Desktop</a></li></ul></ul><li><a href=/tutorials/>Tutorials</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/>Overview</a></li><li><a href>Beginners</a></li><li><a href=/tutorials/beginners/>Quickstart</a></li><li><a href=/tutorials/beginners/basic-ml/>Basic ML with Keras</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/beginners/basic-ml/>Overview</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_basic_classification/>Image Classification</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_basic_regression/>Regression</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_basic_text_classification/>Text Classification</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_basic_text_classification_with_tfhub/>Transfer learning with tfhub</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_overfit_underfit/>Overfitting and Underfitting</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_save_and_restore/>Save and Restore Models</a></li></ul><li><a href=/tutorials/beginners/load/load_csv/>Load and preprocess data</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/beginners/load/load_csv/>Load CSV data</a></li><li><a href=/tutorials/beginners/load/load_image/>Load image data</a></li></ul><li><a href>Advanced</a></li><li><a href=/tutorials/advanced/>Quickstart</a></li><li><a href=/tutorials/advanced/customization/tensors-operations/>Customization</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/advanced/customization/tensors-operations/>Tensors and operations</a></li><li><a href=/tutorials/advanced/customization/custom-layers/>Custom layers</a></li><li><a href=/tutorials/advanced/customization/autodiff/>Automatic differentiation</a></li><li><a href=/tutorials/advanced/customization/custom-training/>Custom training</a></li></ul><li><a href=/tutorials/advanced/images/cnn/>Images</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/advanced/images/cnn/>Convolutional Neural Network</a></li><li><a href=/tutorials/advanced/images/transfer-learning-hub/>Transfer Learning with tfhub</a></li></ul><li><a href=/tutorials/advanced/structured/classify/>Structured data</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/advanced/structured/classify/>Classify structured data</a></li></ul><li><a href=/tutorials/advanced/distributed/distributed_training_with_keras/>Distributed training</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/advanced/distributed/distributed_training_with_keras/>Distributed training with Keras</a></li></ul></ul><li><a href=/guide/>Guide</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/>Overview</a></li><li><a href>Keras</a></li><li><a href=/guide/keras/>Getting started</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/keras/>Overview</a></li><li><a href=/guide/keras/guide_keras/>Keras basics</a></li><li><a href=/guide/keras/sequential_model/>Sequential API</a></li><li><a href=/guide/keras/functional_api/>Functional API</a></li><li><a href=/guide/keras/saving_serializing/>Saving and serializing models</a></li><li><a href=/guide/keras/faq/>Frequently Asked Questions</a></li></ul><li><a href=/guide/keras/custom_layers/>Advanced</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/keras/custom_layers/>Custom Layers</a></li><li><a href=/guide/keras/custom_models/>Custom Models</a></li><li><a href=/guide/keras/training_callbacks/>Training Callbacks</a></li><li><a href=/guide/keras/applications/>Pre-Trained Models</a></li><li><a href=/guide/keras/training_visualization/>Training Visualization</a></li></ul><li><a href=/guide/keras/examples/>Examples</a></li><li><a href>TensorFlow Mechanics</a></li><li><a href=/guide/tensorflow/eager_execution>Basics</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tensorflow/eager_execution/>Eager execution</a></li><li><a href=/guide/tensorflow/variable/>Variables</a></li><li><a href=/guide/tensorflow/tensors/>Tensors</a></li></ul><li><a href=/guide/tensorflow/ragged_tensors>Advanced</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tensorflow/ragged_tensors/>Ragged tensors</a></li></ul><li><a href>Data input pipeline</a></li><li><a href=/guide/tfdatasets/introduction>Overview</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tfdatasets/introduction/>Using Datasets</a></li></ul><li><a href=/guide/tfdatasets/feature_spec>Feature spec API</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tfdatasets/feature_spec/>Feature Spec interface</a></li><li><a href=/guide/tfdatasets/feature_columns/>Feature columns</a></li></ul><li><a href>TensorFlow Hub</a></li><li><a href=/guide/tfhub/intro>Basics</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tfhub/intro/>Overview</a></li><li><a href=/guide/tfhub/hub-with-keras/>Using with Keras</a></li></ul><li><a href=/guide/tfhub/key-concepts>Key concepts</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tfhub/key-concepts/>Key Concepts</a></li></ul><li><a href=/guide/tfhub/examples/>Examples</a></li><li><a href>Model saving</a></li><li><a href=/guide/saving/checkpoints>Checkpoints</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/saving/checkpoints/>Checkpoints</a></li></ul><li><a href=/guide/saving/saved_model>Saved Model</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/saving/saved_model/>Saved Model</a></li></ul></ul><li><a href=/deploy/>Deploy</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/deploy/>Overview</a></li><li><a href=/deploy/plumber/>Plumber</a></li><li><a href=/deploy/shiny/>Shiny</a></li><li><a href=/deploy/docker/>TensorFlow Serving</a></li><li><a href=/deploy/rsconnect/>RStudio Connect</a></li></ul><li><a href=/tools/>Tools</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tools/>Overview</a></li><li><a href=/tools/tfruns/>Training Runs</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tools/tfruns/overview/>Introduction to tfruns</a></li><li><a href=/tools/tfruns/tuning/>Hyperparameter Tuning</a></li><li><a href=/tools/tfruns/managing/>Managing Training Runs</a></li></ul><li><a href=/tools/cloudml/>Cloud ML</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tools/cloudml/getting_started/>Getting Started</a></li><li><a href=/tools/cloudml/training/>Training with CloudML</a></li><li><a href=/tools/cloudml/tuning/>Hyperparameter Tuning</a></li><li><a href=/tools/cloudml/storage/>Google Cloud Storage</a></li><li><a href=/tools/cloudml/deployment/>Deploying Models</a></li></ul><li><a href=/tools/tensorboard/tensorboard/>TensorBoard</a></li></ul><li><a href=/reference/keras>API</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/reference/cloudml/>cloudml</a></li><li><a href=/reference/keras/>keras</a></li><li><a href=/reference/tensorflow/>tensorflow</a></li><li><a href=/reference/tfdatasets/>tfdatasets</a></li><li><a href=/reference/tfruns/>tfruns</a></li></ul><li><a href=/learn/resources/>Learn</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/learn/resources/>Resources</a></li></ul><li><a href=/blog.html>Blog</a></li><ul></ul></ul></div><div id=search-bar class=search-bar><p class=search-bar__icon><i class="fa fa-lg fa-search"></i></p><div class=search-bar__input><input type=text name=search class=st-default-search-input></div><div class=search-bar__exit><i class="fa fa-lg fa-times"></i></div><div class=inline-search-results><ul></ul></div></div></div><div class="page documentation"><div class=side-menu id=side-menu><ul class=side-menu-list data-parenturl=/ style=display:none></ul><ul class=side-menu-list data-parenturl=/installation/ style=display:none><li class=side-menu__item><a href=/installation/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Installing TensorFlow</p></a></li><li class=side-menu__item><a href=/installation/gpu class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Using a GPU</p></a></li></ul><ul class=side-menu-list data-parenturl=/tutorials/ style=display:none><li class=side-menu__item><a href=/tutorials/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Overview</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">Beginners</p></span></li><li class=side-menu__item><a href=/tutorials/beginners/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Quickstart</p></a></li><li class=side-menu__item><a href=/tutorials/beginners/basic-ml/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Basic ML with Keras</p></a></li><li class=side-menu__item><a href=/tutorials/beginners/load/load_csv/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Load and preprocess data</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">Advanced</p></span></li><li class=side-menu__item><a href=/tutorials/advanced/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Quickstart</p></a></li><li class=side-menu__item><a href=/tutorials/advanced/customization/tensors-operations/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Customization</p></a></li><li class=side-menu__item><a href=/tutorials/advanced/images/cnn/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Images</p></a></li><li class=side-menu__item><a href=/tutorials/advanced/structured/classify/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Structured data</p></a></li><li class="side-menu__item active"><a href=/tutorials/advanced/distributed/distributed_training_with_keras/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Distributed training</p></a><ul class=side-menu__sub><span style=display:none>tutorials</span><li class="side-menu__sub__item active"><a id=menu-link-/tutorials/advanced/distributed/distributed_training_with_keras/ class=side-menu__sub__item__text href=/tutorials/advanced/distributed/distributed_training_with_keras/ data-url=/tutorials/advanced/distributed/distributed_training_with_keras/>Distributed training with Keras</a></li></ul></li></ul><ul class=side-menu-list data-parenturl=/guide/ style=display:none><li class=side-menu__item><a href=/guide/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Overview</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">Keras</p></span></li><li class=side-menu__item><a href=/guide/keras/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Getting started</p></a></li><li class=side-menu__item><a href=/guide/keras/custom_layers/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Advanced</p></a></li><li class=side-menu__item><a href=/guide/keras/examples/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Examples</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">TensorFlow Mechanics</p></span></li><li class=side-menu__item><a href=/guide/tensorflow/eager_execution class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Basics</p></a></li><li class=side-menu__item><a href=/guide/tensorflow/ragged_tensors class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Advanced</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">Data input pipeline</p></span></li><li class=side-menu__item><a href=/guide/tfdatasets/introduction class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Overview</p></a></li><li class=side-menu__item><a href=/guide/tfdatasets/feature_spec class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Feature spec API</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">TensorFlow Hub</p></span></li><li class=side-menu__item><a href=/guide/tfhub/intro class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Basics</p></a></li><li class=side-menu__item><a href=/guide/tfhub/key-concepts class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Key concepts</p></a></li><li class=side-menu__item><a href=/guide/tfhub/examples/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Examples</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">Model saving</p></span></li><li class=side-menu__item><a href=/guide/saving/checkpoints class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Checkpoints</p></a></li><li class=side-menu__item><a href=/guide/saving/saved_model class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Saved Model</p></a></li></ul><ul class=side-menu-list data-parenturl=/deploy/ style=display:none><li class=side-menu__item><a href=/deploy/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Overview</p></a></li><li class=side-menu__item><a href=/deploy/plumber/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Plumber</p></a></li><li class=side-menu__item><a href=/deploy/shiny/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Shiny</p></a></li><li class=side-menu__item><a href=/deploy/docker/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>TensorFlow Serving</p></a></li><li class=side-menu__item><a href=/deploy/rsconnect/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>RStudio Connect</p></a></li></ul><ul class=side-menu-list data-parenturl=/tools/ style=display:none><li class=side-menu__item><a href=/tools/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Overview</p></a></li><li class=side-menu__item><a href=/tools/tfruns/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Training Runs</p></a></li><li class=side-menu__item><a href=/tools/cloudml/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Cloud ML</p></a></li><li class=side-menu__item><a href=/tools/tensorboard/tensorboard/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>TensorBoard</p></a></li></ul><ul class=side-menu-list data-parenturl=/reference/keras style=display:none><li class=side-menu__item><a href=/reference/cloudml/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>cloudml</p></a></li><li class=side-menu__item><a href=/reference/keras/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>keras</p></a></li><li class=side-menu__item><a href=/reference/tensorflow/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>tensorflow</p></a></li><li class=side-menu__item><a href=/reference/tfdatasets/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>tfdatasets</p></a></li><li class=side-menu__item><a href=/reference/tfruns/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>tfruns</p></a></li></ul><ul class=side-menu-list data-parenturl=/learn/resources/ style=display:none><li class=side-menu__item><a href=/learn/resources/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Resources</p></a></li></ul><ul class=side-menu-list data-parenturl=/blog.html style=display:none></ul></div><div class=content><h1 class=content-header>Distributed training with Keras</h1><div class=markdowned><div class=doc-page><div class=doc-page-index><ul id=gumshoe-container data-gumshoe></ul></div><div class=doc-page-body><div id=overview class="section level2"><h2>Overview</h2><p>The <code>tf$distribute$Strategy</code> API provides an abstraction for distributing your training across multiple processing units. The goal is to allow users to enable distributed training using existing models and training code, with minimal changes.</p><p>This tutorial uses the <code>tf$distribute$MirroredStrategy</code>, which does in-graph replication with synchronous training on many GPUs on one machine. Essentially, it copies all of the model’s variables to each processor. Then, it uses <a href=http://mpitutorial.com/tutorials/mpi-reduce-and-allreduce/>all-reduce</a> to combine the gradients from all processors and applies the combined value to all copies of the model.</p><p><code>MirroredStategy</code> is one of several distribution strategy available in TensorFlow core. You can read about more strategies in the <a href=TBD%20guide>distribution strategy guide</a>.</p><div id=keras-api class="section level3"><h3>Keras API</h3><p>This example uses the <code>keras</code> API to build the model and training loop. For custom training loops, see the <a href=TBD%20tutorial>Custom training loops</a> tutorial.</p><div class=sourceCode id=cb1><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb1-1 data-line-number=1><span class=kw><a href=https://rdrr.io/r/base/library.html>library</a></span>(tensorflow)</a>
<a class=sourceLine id=cb1-2 data-line-number=2><span class=kw><a href=https://rdrr.io/r/base/library.html>library</a></span>(keras)</a>
<a class=sourceLine id=cb1-3 data-line-number=3><span class=kw><a href=https://rdrr.io/r/base/library.html>library</a></span>(tfdatasets)</a>
<a class=sourceLine id=cb1-4 data-line-number=4><span class=co># used to load the MNIST dataset</span></a>
<a class=sourceLine id=cb1-5 data-line-number=5><span class=kw><a href=https://rdrr.io/r/base/library.html>library</a></span>(tfds)</a>
<a class=sourceLine id=cb1-6 data-line-number=6></a>
<a class=sourceLine id=cb1-7 data-line-number=7><span class=kw><a href=https://rdrr.io/r/base/library.html>library</a></span>(purrr)</a>
<a class=sourceLine id=cb1-8 data-line-number=8><span class=kw><a href=https://rdrr.io/r/base/library.html>library</a></span>(glue)</a></code></pre></div></div><div id=download-the-dataset class="section level3"><h3>Download the dataset</h3><p>Download the MNIST dataset and load it using <a href=https://github.com/rstudio/tfds>tfds</a>. This returns a dataset in <code>tfdatasets</code> format.</p><div class=sourceCode id=cb2><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb2-1 data-line-number=1><span class=co># if you haven't done it yet:</span></a>
<a class=sourceLine id=cb2-2 data-line-number=2><span class=co># tfds::install_tfds()</span></a>
<a class=sourceLine id=cb2-3 data-line-number=3>mnist &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/pkg/tfds/man/tfds_load.html>tfds_load</a></span>(<span class=st>"mnist"</span>)</a>
<a class=sourceLine id=cb2-4 data-line-number=4>info &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/summary.html>summary</a></span>(mnist)</a></code></pre></div></div><div id=define-distribution-strategy class="section level3"><h3>Define distribution strategy</h3><p>Create a <code>MirroredStrategy</code> object. This will handle distribution, and provides a context manager (<code>tf$distribute$MirroredStrategy$scope</code>) to build your model inside.</p><div class=sourceCode id=cb3><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb3-1 data-line-number=1>strategy &lt;-<span class=st> </span>tf<span class=op>$</span>distribute<span class=op>$</span><span class=kw>MirroredStrategy</span>()</a>
<a class=sourceLine id=cb3-2 data-line-number=2>strategy<span class=op>$</span>num_replicas_in_sync</a></code></pre></div></div><div id=setup-input-pipeline class="section level3"><h3>Setup input pipeline</h3><p>When training a model with multiple GPUs, you can use the extra computing power effectively by increasing the batch size. In general, use the largest batch size that fits the GPU memory, and tune the learning rate accordingly.</p><div class=sourceCode id=cb4><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb4-1 data-line-number=1>num_train_examples &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/integer.html>as.integer</a></span>(info<span class=op>$</span>splits[[<span class=dv>2</span>]]<span class=op>$</span>statistics<span class=op>$</span>numExamples)</a>
<a class=sourceLine id=cb4-2 data-line-number=2>num_test_examples &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/integer.html>as.integer</a></span>(info<span class=op>$</span>splits[[<span class=dv>1</span>]]<span class=op>$</span>statistics<span class=op>$</span>numExamples)</a>
<a class=sourceLine id=cb4-3 data-line-number=3></a>
<a class=sourceLine id=cb4-4 data-line-number=4>BUFFER_SIZE &lt;-<span class=st> </span><span class=dv>10000</span></a>
<a class=sourceLine id=cb4-5 data-line-number=5></a>
<a class=sourceLine id=cb4-6 data-line-number=6>BATCH_SIZE_PER_REPLICA &lt;-<span class=st> </span><span class=dv>64</span></a>
<a class=sourceLine id=cb4-7 data-line-number=7>BATCH_SIZE &lt;-<span class=st> </span>BATCH_SIZE_PER_REPLICA <span class=op>*</span><span class=st> </span>strategy<span class=op>$</span>num_replicas_in_sync</a></code></pre></div><p>Pixel values, which are 0-255, have to be normalized to the 0-1 range. Furthermore, we shuffle and batch the train and test datasets. Notice we are also keeping an in-memory cache of the training data to improve performance.</p><div class=sourceCode id=cb5><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb5-1 data-line-number=1>train_dataset &lt;-<span class=st> </span>mnist<span class=op>$</span>train <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb5-2 data-line-number=2><span class=st>  </span><span class=kw><a href=../../../tools/tfdatasets/reference/dataset_map.html>dataset_map</a></span>(<span class=cf>function</span>(record) {</a>
<a class=sourceLine id=cb5-3 data-line-number=3>    record<span class=op>$</span>image &lt;-<span class=st> </span>tf<span class=op>$</span><span class=kw>cast</span>(record<span class=op>$</span>image, tf<span class=op>$</span>float32) <span class=op>/</span><span class=st> </span><span class=dv>255</span></a>
<a class=sourceLine id=cb5-4 data-line-number=4>    record}) <span class=op>%&gt;%</span></a>
<a class=sourceLine id=cb5-5 data-line-number=5><span class=st>  </span><span class=kw><a href=../../../tools/tfdatasets/reference/dataset_cache.html>dataset_cache</a></span>() <span class=op>%&gt;%</span></a>
<a class=sourceLine id=cb5-6 data-line-number=6><span class=st>  </span><span class=kw><a href=../../../tools/tfdatasets/reference/dataset_shuffle.html>dataset_shuffle</a></span>(BUFFER_SIZE) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb5-7 data-line-number=7><span class=st>  </span><span class=kw><a href=../../../tools/tfdatasets/reference/dataset_batch.html>dataset_batch</a></span>(BATCH_SIZE) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb5-8 data-line-number=8><span class=st>  </span><span class=kw><a href=../../../tools/tfdatasets/reference/dataset_map.html>dataset_map</a></span>(unname)</a>
<a class=sourceLine id=cb5-9 data-line-number=9></a>
<a class=sourceLine id=cb5-10 data-line-number=10>test_dataset &lt;-<span class=st> </span>mnist<span class=op>$</span>test <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb5-11 data-line-number=11><span class=st> </span><span class=kw><a href=../../../tools/tfdatasets/reference/dataset_map.html>dataset_map</a></span>(<span class=cf>function</span>(record) {</a>
<a class=sourceLine id=cb5-12 data-line-number=12>    record<span class=op>$</span>image &lt;-<span class=st> </span>tf<span class=op>$</span><span class=kw>cast</span>(record<span class=op>$</span>image, tf<span class=op>$</span>float32) <span class=op>/</span><span class=st> </span><span class=dv>255</span></a>
<a class=sourceLine id=cb5-13 data-line-number=13>    record}) <span class=op>%&gt;%</span></a>
<a class=sourceLine id=cb5-14 data-line-number=14><span class=st>  </span><span class=kw><a href=../../../tools/tfdatasets/reference/dataset_batch.html>dataset_batch</a></span>(BATCH_SIZE) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb5-15 data-line-number=15><span class=st>  </span><span class=kw><a href=../../../tools/tfdatasets/reference/dataset_map.html>dataset_map</a></span>(unname)</a></code></pre></div></div><div id=create-the-model class="section level3"><h3>Create the model</h3><p>Create and compile the Keras model in the context of <code>strategy$scope</code>.</p><div class=sourceCode id=cb6><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb6-1 data-line-number=1><span class=kw><a href=https://rdrr.io/r/base/with.html>with</a></span> (strategy<span class=op>$</span><span class=kw>scope</span>(), {</a>
<a class=sourceLine id=cb6-2 data-line-number=2>   model &lt;-<span class=st> </span><span class=kw><a href=../../../keras/reference/keras_model_sequential.html>keras_model_sequential</a></span>() <span class=op>%&gt;%</span></a>
<a class=sourceLine id=cb6-3 data-line-number=3><span class=st>     </span><span class=kw><a href=../../../keras/reference/layer_conv_2d.html>layer_conv_2d</a></span>(</a>
<a class=sourceLine id=cb6-4 data-line-number=4>       <span class=dt>filters =</span> <span class=dv>32</span>,</a>
<a class=sourceLine id=cb6-5 data-line-number=5>       <span class=dt>kernel_size =</span> <span class=dv>3</span>,</a>
<a class=sourceLine id=cb6-6 data-line-number=6>       <span class=dt>activation =</span> <span class=st>'relu'</span>,</a>
<a class=sourceLine id=cb6-7 data-line-number=7>       <span class=dt>input_shape =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>28</span>, <span class=dv>28</span>, <span class=dv>1</span>)</a>
<a class=sourceLine id=cb6-8 data-line-number=8>       ) <span class=op>%&gt;%</span></a>
<a class=sourceLine id=cb6-9 data-line-number=9><span class=st>     </span><span class=kw><a href=../../../keras/reference/layer_max_pooling_2d.html>layer_max_pooling_2d</a></span>() <span class=op>%&gt;%</span></a>
<a class=sourceLine id=cb6-10 data-line-number=10><span class=st>     </span><span class=kw><a href=../../../keras/reference/layer_flatten.html>layer_flatten</a></span>() <span class=op>%&gt;%</span></a>
<a class=sourceLine id=cb6-11 data-line-number=11><span class=st>     </span><span class=kw><a href=../../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>64</span>, <span class=dt>activation =</span> <span class=st>'relu'</span>) <span class=op>%&gt;%</span></a>
<a class=sourceLine id=cb6-12 data-line-number=12><span class=st>     </span><span class=kw><a href=../../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>10</span>, <span class=dt>activation =</span> <span class=st>'softmax'</span>)</a>
<a class=sourceLine id=cb6-13 data-line-number=13>   </a>
<a class=sourceLine id=cb6-14 data-line-number=14>  model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../../keras/reference/reexports.html>compile</a></span>(</a>
<a class=sourceLine id=cb6-15 data-line-number=15>    <span class=dt>loss =</span> <span class=st>'sparse_categorical_crossentropy'</span>,</a>
<a class=sourceLine id=cb6-16 data-line-number=16>    <span class=dt>optimizer =</span> <span class=st>'adam'</span>,</a>
<a class=sourceLine id=cb6-17 data-line-number=17>    <span class=dt>metrics =</span> <span class=st>'accuracy'</span>)</a>
<a class=sourceLine id=cb6-18 data-line-number=18>})</a></code></pre></div></div><div id=define-the-callbacks class="section level3"><h3>Define the callbacks</h3><p>The callbacks used here are:</p><ul><li>TensorBoard: This callback writes a log for TensorBoard which allows you to visualize the graphs.</li><li>Model Checkpoint: This callback saves the model after every epoch.</li><li>Learning Rate Scheduler: Using this callback, you can schedule the learning rate to change after every epoch/batch.</li></ul><p>For illustrative purposes, add a print callback to display the learning rate.</p><div class=sourceCode id=cb7><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb7-1 data-line-number=1><span class=co># Define the checkpoint directory to store the checkpoints</span></a>
<a class=sourceLine id=cb7-2 data-line-number=2>checkpoint_dir &lt;-<span class=st> './training_checkpoints'</span></a>
<a class=sourceLine id=cb7-3 data-line-number=3><span class=co># Name of the checkpoint files</span></a>
<a class=sourceLine id=cb7-4 data-line-number=4>checkpoint_prefix &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/file.path.html>file.path</a></span>(checkpoint_dir, <span class=st>"ckpt_{epoch}"</span>)</a></code></pre></div><div class=sourceCode id=cb8><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb8-1 data-line-number=1><span class=co># Function for decaying the learning rate.</span></a>
<a class=sourceLine id=cb8-2 data-line-number=2><span class=co># You can define any decay function you need.</span></a>
<a class=sourceLine id=cb8-3 data-line-number=3>decay &lt;-<span class=st> </span><span class=cf>function</span>(epoch, lr) {</a>
<a class=sourceLine id=cb8-4 data-line-number=4>  <span class=cf>if</span> (epoch <span class=op>&lt;</span><span class=st> </span><span class=dv>3</span>) <span class=fl>1e-3</span></a>
<a class=sourceLine id=cb8-5 data-line-number=5>    <span class=cf>else</span> <span class=cf>if</span> (epoch <span class=op>&gt;=</span><span class=st> </span><span class=dv>3</span> <span class=op>&amp;&amp;</span><span class=st> </span>epoch <span class=op>&lt;</span><span class=st> </span><span class=dv>7</span>) <span class=fl>1e-4</span></a>
<a class=sourceLine id=cb8-6 data-line-number=6>      <span class=cf>else</span> <span class=fl>1e-5</span></a>
<a class=sourceLine id=cb8-7 data-line-number=7>}</a></code></pre></div><div class=sourceCode id=cb9><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb9-1 data-line-number=1><span class=co># Callback for printing the LR at the end of each epoch.</span></a>
<a class=sourceLine id=cb9-2 data-line-number=2>PrintLR &lt;-<span class=st> </span>R6<span class=op>::</span><span class=kw><a href=https://rdrr.io/pkg/R6/man/R6Class.html>R6Class</a></span>(<span class=st>"PrintLR"</span>,</a>
<a class=sourceLine id=cb9-3 data-line-number=3>  <span class=dt>inherit =</span> KerasCallback,</a>
<a class=sourceLine id=cb9-4 data-line-number=4>  </a>
<a class=sourceLine id=cb9-5 data-line-number=5>  <span class=dt>public =</span> <span class=kw><a href=https://rdrr.io/r/base/list.html>list</a></span>(</a>
<a class=sourceLine id=cb9-6 data-line-number=6>    </a>
<a class=sourceLine id=cb9-7 data-line-number=7>    <span class=dt>losses =</span> <span class=ot>NULL</span>,</a>
<a class=sourceLine id=cb9-8 data-line-number=8>     </a>
<a class=sourceLine id=cb9-9 data-line-number=9>    <span class=dt>on_epoch_end =</span> <span class=cf>function</span>(epoch, <span class=dt>logs =</span> <span class=kw><a href=https://rdrr.io/r/base/list.html>list</a></span>()) {</a>
<a class=sourceLine id=cb9-10 data-line-number=10>      tf<span class=op>$</span><span class=kw><a href=https://rdrr.io/r/base/print.html>print</a></span>(<span class=kw><a href=https://rdrr.io/pkg/glue/man/glue.html>glue</a></span>(<span class=st>'</span><span class=ch>\n</span><span class=st>Learning rate for epoch {epoch} is {as.numeric(model$optimizer$lr)}</span><span class=ch>\n</span><span class=st>'</span>))</a>
<a class=sourceLine id=cb9-11 data-line-number=11>    }</a>
<a class=sourceLine id=cb9-12 data-line-number=12>))</a>
<a class=sourceLine id=cb9-13 data-line-number=13></a>
<a class=sourceLine id=cb9-14 data-line-number=14>print_lr &lt;-<span class=st> </span>PrintLR<span class=op>$</span><span class=kw>new</span>()</a></code></pre></div><div class=sourceCode id=cb10><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb10-1 data-line-number=1>callbacks &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/list.html>list</a></span>(</a>
<a class=sourceLine id=cb10-2 data-line-number=2>    <span class=kw><a href=../../../keras/reference/callback_tensorboard.html>callback_tensorboard</a></span>(<span class=dt>log_dir =</span> <span class=st>'/tmp/logs'</span>),</a>
<a class=sourceLine id=cb10-3 data-line-number=3>    <span class=kw><a href=../../../keras/reference/callback_model_checkpoint.html>callback_model_checkpoint</a></span>(<span class=dt>filepath =</span> checkpoint_prefix, <span class=dt>save_weights_only =</span> <span class=ot>TRUE</span>),</a>
<a class=sourceLine id=cb10-4 data-line-number=4>    <span class=kw><a href=../../../keras/reference/callback_learning_rate_scheduler.html>callback_learning_rate_scheduler</a></span>(decay),</a>
<a class=sourceLine id=cb10-5 data-line-number=5>    print_lr</a>
<a class=sourceLine id=cb10-6 data-line-number=6>)</a></code></pre></div></div><div id=train-and-evaluate class="section level3"><h3>Train and evaluate</h3><p>Now, train the model in the usual way, calling fit on the model and passing in the dataset created at the beginning of the tutorial. This step is the same whether you are distributing the training or not.</p><div class=sourceCode id=cb11><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb11-1 data-line-number=1>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../../keras/reference/reexports.html>fit</a></span>(train_dataset, <span class=dt>epochs =</span> <span class=dv>12</span>, <span class=dt>callbacks =</span> callbacks)</a></code></pre></div><p>As you can see below, the checkpoints are getting saved.</p><div class=sourceCode id=cb12><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb12-1 data-line-number=1><span class=kw><a href=https://rdrr.io/r/base/list.files.html>list.files</a></span>(checkpoint_dir)</a></code></pre></div><p>To see how the model performs, load the latest checkpoint and call evaluate on the test data.</p><div class=sourceCode id=cb13><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb13-1 data-line-number=1>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../../keras/reference/save_model_weights_tf.html>load_model_weights_tf</a></span>(tf<span class=op>$</span>train<span class=op>$</span><span class=kw>latest_checkpoint</span>(checkpoint_dir))</a>
<a class=sourceLine id=cb13-2 data-line-number=2></a>
<a class=sourceLine id=cb13-3 data-line-number=3>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../../tensorflow/reference/evaluate.html>evaluate</a></span>(test_dataset)</a></code></pre></div><div class=sourceCode id=cb14><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb14-1 data-line-number=1><span class=kw><a href=../../../tensorflow/reference/tensorboard.html>tensorboard</a></span>(<span class=dt>log_dir =</span> <span class=st>"/tmp/logs"</span>)</a></code></pre></div></div></div><div id=export-to-savedmodel class="section level2"><h2>Export to SavedModel</h2><p>Export the graph and the variables to the platform-agnostic SavedModel format. After your model is saved, you can load it with or without the scope.</p><div class=sourceCode id=cb15><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb15-1 data-line-number=1>path &lt;-<span class=st> 'saved_model/'</span></a>
<a class=sourceLine id=cb15-2 data-line-number=2>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../../keras/reference/save_model_tf.html>save_model_tf</a></span>(path)</a></code></pre></div><p>Load the model without <code>strategy$scope</code>.</p><div class=sourceCode id=cb16><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb16-1 data-line-number=1>unreplicated_model &lt;-<span class=st> </span><span class=kw><a href=../../../keras/reference/save_model_tf.html>load_model_tf</a></span>(path)</a>
<a class=sourceLine id=cb16-2 data-line-number=2></a>
<a class=sourceLine id=cb16-3 data-line-number=3>unreplicated_model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../../keras/reference/reexports.html>compile</a></span>(</a>
<a class=sourceLine id=cb16-4 data-line-number=4>    <span class=dt>loss =</span> <span class=st>'sparse_categorical_crossentropy'</span>,</a>
<a class=sourceLine id=cb16-5 data-line-number=5>    <span class=dt>optimizer =</span> <span class=st>'adam'</span>,</a>
<a class=sourceLine id=cb16-6 data-line-number=6>    <span class=dt>metrics =</span> <span class=st>'accuracy'</span>)</a>
<a class=sourceLine id=cb16-7 data-line-number=7></a>
<a class=sourceLine id=cb16-8 data-line-number=8>unreplicated_model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../../tensorflow/reference/evaluate.html>evaluate</a></span>(test_dataset)</a></code></pre></div><p>Load the model with <code>strategy$scope</code>.</p><div class=sourceCode id=cb17><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb17-1 data-line-number=1><span class=kw><a href=https://rdrr.io/r/base/with.html>with</a></span> (strategy<span class=op>$</span><span class=kw>scope</span>(), {</a>
<a class=sourceLine id=cb17-2 data-line-number=2>  replicated_model &lt;-<span class=st> </span><span class=kw><a href=../../../keras/reference/save_model_tf.html>load_model_tf</a></span>(path)</a>
<a class=sourceLine id=cb17-3 data-line-number=3></a>
<a class=sourceLine id=cb17-4 data-line-number=4>  replicated_model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../../keras/reference/reexports.html>compile</a></span>(</a>
<a class=sourceLine id=cb17-5 data-line-number=5>    <span class=dt>loss =</span> <span class=st>'sparse_categorical_crossentropy'</span>,</a>
<a class=sourceLine id=cb17-6 data-line-number=6>    <span class=dt>optimizer =</span> <span class=st>'adam'</span>,</a>
<a class=sourceLine id=cb17-7 data-line-number=7>    <span class=dt>metrics =</span> <span class=st>'accuracy'</span>)</a>
<a class=sourceLine id=cb17-8 data-line-number=8></a>
<a class=sourceLine id=cb17-9 data-line-number=9>  replicated_model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../../tensorflow/reference/evaluate.html>evaluate</a></span>(test_dataset)</a>
<a class=sourceLine id=cb17-10 data-line-number=10>})</a></code></pre></div></div><div id=examples-and-tutorials class="section level2"><h2>Examples and Tutorials</h2><p>Here are some examples for using distribution strategy with keras fit/compile:</p><ol style=list-style-type:decimal><li><a href=tbd>Transformer example trained using tf.distribute.MirroredStrategy</a></li><li><a href=tbd>NCF example trained using tf.distribute.MirroredStrategy</a></li></ol><p>Call evaluate as before using appropriate datasets.</p></div></div></div></div><footer>Copyright © 2015-2019 The TensorFlow Authors and RStudio, Inc.
<script type=text/javascript>(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');_st('install','Ne8tbLfE121Pkj3xMr_G','2.0.0');</script></footer></div></div></body></html>