<!doctype html><html><head><script>theBaseUrl=location.origin+"/";</script><meta charset=utf-8><meta name=viewport content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1"><title>Text Classification</title><meta name=generator content="Hugo 0.58.3"><meta name=description content="Documentation for the TensorFlow for R interface"><link rel=canonical href=/tutorials/beginners/basic-ml/tutorial_basic_text_classification/><meta name=author content="J.J. Allaire"><meta property=og:url content=/tutorials/beginners/basic-ml/tutorial_basic_text_classification/><meta property=og:title content="TensorFlow for R"><meta name=apple-mobile-web-app-title content="TensorFlow for R"><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=black-translucent><style>@font-face{font-family:icon;src:url(fonts/icon.eot?52m981);src:url(fonts/icon.eot?#iefix52m981) format('embedded-opentype'),url(fonts/icon.woff?52m981) format('woff'),url(fonts/icon.ttf?52m981) format('truetype'),url(fonts/icon.svg?52m981#icon) format('svg');font-weight:400;font-style:normal}</style><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/site-styles.css><script src=/js/vendor.js></script><script src=/js/app.js></script><link rel="shortcut icon" href=/images/favicon.png><script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-20375833-3');</script><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script></head><body><div class=single-page><nav data-gumshoe-header aria-label=Header id=header class=top-menu><div class=left><a href=/ data-parenturl class="top-menu-item site-title">TensorFlow for R</a>
<span class=logo-from>from</span>
<a href=/><div id=logo class=logo></div></a></div><div class=right><div class=top-menu-items id=top-menu-items><a href=/ data-parenturl=/ class=top-menu-item>Home</a>
<a href=/installation/ data-parenturl=/installation/ class=top-menu-item>Installation</a>
<a href=/tutorials/ data-parenturl=/tutorials/ class=top-menu-item>Tutorials</a>
<a href=/guide/ data-parenturl=/guide/ class=top-menu-item>Guide</a>
<a href=/deploy/ data-parenturl=/deploy/ class=top-menu-item>Deploy</a>
<a href=/tools/ data-parenturl=/tools/ class=top-menu-item>Tools</a>
<a href=/reference/keras data-parenturl=/reference/keras class=top-menu-item>API</a>
<a href=/learn/resources/ data-parenturl=/learn/resources/ class=top-menu-item>Learn</a>
<a href=/blog.html data-parenturl=/blog.html class=top-menu-item>Blog</a></div><a href=https://github.com/rstudio/keras class=github-logo><i class="fa fa-lg fa-github" aria-hidden=true></i></a><div class=search-button><i class="fa fa-lg fa-search"></i></div></div></nav><nav aria-label=Header id=mobile-header><a href=/>TensorFlow for R</a><div class=right><a href=https://github.com/rstudio/keras class=github-logo><i class="fa fa-lg fa-github" aria-hidden=true></i></a><div class=hamburger><i class="fa fa-lg fa-bars" aria-hidden=true></i></div></div></nav><div id=mobile-menu-container><ul id=mobile-menu><li><a href=/>Home</a></li><ul></ul><li><a href=/installation/>Installation</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/installation/>Installing TensorFlow</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/installation/>Quick start</a></li><li><a href=/installation/custom/>Custom Installation</a></li></ul><li><a href=/installation/gpu>Using a GPU</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/installation/gpu/>Overview</a></li><li><a href=/installation/gpu/local_gpu/>Local GPU</a></li><li><a href=/installation/gpu/cloud_server_gpu/>Cloud Server</a></li><li><a href=/installation/gpu/cloud_desktop_gpu/>Cloud Desktop</a></li></ul></ul><li><a href=/tutorials/>Tutorials</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/>Overview</a></li><li><a href>Beginners</a></li><li><a href=/tutorials/beginners/>Quickstart</a></li><li><a href=/tutorials/beginners/basic-ml/>Basic ML with Keras</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/beginners/basic-ml/>Overview</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_basic_classification/>Image Classification</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_basic_regression/>Regression</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_basic_text_classification/>Text Classification</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_basic_text_classification_with_tfhub/>Transfer learning with tfhub</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_overfit_underfit/>Overfitting and Underfitting</a></li><li><a href=/tutorials/beginners/basic-ml/tutorial_save_and_restore/>Save and Restore Models</a></li></ul><li><a href=/tutorials/beginners/load/load_csv/>Load and preprocess data</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/beginners/load/load_csv/>Load CSV data</a></li><li><a href=/tutorials/beginners/load/load_image/>Load image data</a></li></ul><li><a href>Advanced</a></li><li><a href=/tutorials/advanced/>Quickstart</a></li><li><a href=/tutorials/advanced/customization/tensors-operations/>Customization</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/advanced/customization/tensors-operations/>Tensors and operations</a></li><li><a href=/tutorials/advanced/customization/custom-layers/>Custom layers</a></li><li><a href=/tutorials/advanced/customization/autodiff/>Automatic differentiation</a></li><li><a href=/tutorials/advanced/customization/custom-training/>Custom training</a></li></ul><li><a href=/tutorials/advanced/images/cnn/>Images</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/advanced/images/cnn/>Convolutional Neural Network</a></li><li><a href=/tutorials/advanced/images/transfer-learning-hub/>Transfer Learning with tfhub</a></li></ul><li><a href=/tutorials/advanced/structured/classify/>Structured data</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tutorials/advanced/structured/classify/>Classify structured data</a></li></ul><li><a href=/tutorials/advanced/distributed/distributed_training_with_keras/>Distributed training</a></li></ul><li><a href=/guide/>Guide</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/>Overview</a></li><li><a href>Keras</a></li><li><a href=/guide/keras/>Getting started</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/keras/>Overview</a></li><li><a href=/guide/keras/guide_keras/>Keras basics</a></li><li><a href=/guide/keras/sequential_model/>Sequential API</a></li><li><a href=/guide/keras/functional_api/>Functional API</a></li><li><a href=/guide/keras/saving_serializing/>Saving and serializing models</a></li><li><a href=/guide/keras/faq/>Frequently Asked Questions</a></li></ul><li><a href=/guide/keras/custom_layers/>Advanced</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/keras/custom_layers/>Custom Layers</a></li><li><a href=/guide/keras/custom_models/>Custom Models</a></li><li><a href=/guide/keras/training_callbacks/>Training Callbacks</a></li><li><a href=/guide/keras/applications/>Pre-Trained Models</a></li><li><a href=/guide/keras/training_visualization/>Training Visualization</a></li></ul><li><a href=/guide/keras/examples/>Examples</a></li><li><a href>TensorFlow Mechanics</a></li><li><a href=/guide/tensorflow/eager_execution>Basics</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tensorflow/eager_execution/>Eager execution</a></li><li><a href=/guide/tensorflow/variable/>Variables</a></li><li><a href=/guide/tensorflow/tensors/>Tensors</a></li></ul><li><a href=/guide/tensorflow/ragged_tensors>Advanced</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tensorflow/ragged_tensors/>Ragged tensors</a></li></ul><li><a href>Data input pipeline</a></li><li><a href=/guide/tfdatasets/introduction>Overview</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tfdatasets/introduction/>Using Datasets</a></li></ul><li><a href=/guide/tfdatasets/feature_spec>Feature spec API</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tfdatasets/feature_spec/>Feature Spec interface</a></li><li><a href=/guide/tfdatasets/feature_columns/>Feature columns</a></li></ul><li><a href>TensorFlow Hub</a></li><li><a href=/guide/tfhub/intro>Basics</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tfhub/intro/>Overview</a></li><li><a href=/guide/tfhub/hub-with-keras/>Using with Keras</a></li></ul><li><a href=/guide/tfhub/key-concepts>Key concepts</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tfhub/key-concepts/>Key Concepts</a></li></ul><li><a href=/guide/tfhub/examples/>Examples</a></li><li><a href>Model saving</a></li><li><a href=/guide/saving/checkpoints>Checkpoints</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/saving/checkpoints/>Checkpoints</a></li></ul><li><a href=/guide/saving/saved_model>Saved Model</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/saving/saved_model/>Saved Model</a></li></ul><li><a href>Estimators</a></li><li><a href=/tfestimators>Basics</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tfestimators/estimator_basics/>Estimator Basics</a></li><li><a href=/guide/tfestimators/input_functions/>Input Functions</a></li><li><a href=/guide/tfestimators/feature_columns/>Feature Columns</a></li><li><a href=/guide/tfestimators/tensorboard/>TensorBoard</a></li></ul><li><a href=/guide/tfestimators/creating_estimators/>Advanced</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/guide/tfestimators/run_hooks/>Run Hooks</a></li><li><a href=/guide/tfestimators/creating_estimators/>Custom Estimators</a></li><li><a href=/guide/tfestimators/parsing_spec/>Parsing Utilities</a></li><li><a href=/guide/tfestimators/dataset_api/>Dataset API</a></li></ul><li><a href=/guide/tfestimators/examples>Examples</a></li></ul><li><a href=/deploy/>Deploy</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/deploy/>Overview</a></li><li><a href=/deploy/plumber/>Plumber</a></li><li><a href=/deploy/shiny/>Shiny</a></li><li><a href=/deploy/docker/>TensorFlow Serving</a></li><li><a href=/deploy/rsconnect/>RStudio Connect</a></li></ul><li><a href=/tools/>Tools</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tools/>Overview</a></li><li><a href=/tools/tfruns/>Training Runs</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tools/tfruns/overview/>Introduction to tfruns</a></li><li><a href=/tools/tfruns/tuning/>Hyperparameter Tuning</a></li><li><a href=/tools/tfruns/managing/>Managing Training Runs</a></li></ul><li><a href=/tools/cloudml/>Cloud ML</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tools/cloudml/getting_started/>Getting Started</a></li><li><a href=/tools/cloudml/training/>Training with CloudML</a></li><li><a href=/tools/cloudml/tuning/>Hyperparameter Tuning</a></li><li><a href=/tools/cloudml/storage/>Google Cloud Storage</a></li><li><a href=/tools/cloudml/deployment/>Deploying Models</a></li></ul><li><a href=/tools/tensorboard/>Tensorboard</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/tools/tensorboard/tensorboard/>Getting started</a></li><li><a href=/tools/tensorboard/hparams/>HParams Dashboard</a></li></ul></ul><li><a href=/reference/keras>API</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/reference/cloudml/>cloudml</a></li><li><a href=/reference/keras/>keras</a></li><li><a href=/reference/tensorflow/>tensorflow</a></li><li><a href=/reference/tfdatasets/>tfdatasets</a></li><li><a href=/reference/tfestimators/>tfestimators</a></li><li><a href=/reference/tfruns/>tfruns</a></li></ul><li><a href=/learn/resources/>Learn</a>
<i class="fa fa-chevron-right" aria-hidden=true></i></li><ul><li><a href=/learn/resources/>Resources</a></li></ul><li><a href=/blog.html>Blog</a></li><ul></ul></ul></div><div id=search-bar class=search-bar><p class=search-bar__icon><i class="fa fa-lg fa-search"></i></p><div class=search-bar__input><input type=text name=search class=st-default-search-input></div><div class=search-bar__exit><i class="fa fa-lg fa-times"></i></div><div class=inline-search-results><ul></ul></div></div></div><div class="page documentation"><div class=side-menu id=side-menu><ul class=side-menu-list data-parenturl=/ style=display:none></ul><ul class=side-menu-list data-parenturl=/installation/ style=display:none><li class=side-menu__item><a href=/installation/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Installing TensorFlow</p></a></li><li class=side-menu__item><a href=/installation/gpu class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Using a GPU</p></a></li></ul><ul class=side-menu-list data-parenturl=/tutorials/ style=display:none><li class=side-menu__item><a href=/tutorials/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Overview</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">Beginners</p></span></li><li class=side-menu__item><a href=/tutorials/beginners/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Quickstart</p></a></li><li class="side-menu__item active"><a href=/tutorials/beginners/basic-ml/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Basic ML with Keras</p></a><ul class=side-menu__sub><span style=display:none>tutorials</span><li class=side-menu__sub__item><a id=menu-link-/tutorials/beginners/basic-ml/ class=side-menu__sub__item__text href=/tutorials/beginners/basic-ml/ data-url=/tutorials/beginners/basic-ml/>Overview</a></li><span style=display:none>tutorials</span><li class=side-menu__sub__item><a id=menu-link-/tutorials/beginners/basic-ml/tutorial_basic_classification/ class=side-menu__sub__item__text href=/tutorials/beginners/basic-ml/tutorial_basic_classification/ data-url=/tutorials/beginners/basic-ml/tutorial_basic_classification/>Image Classification</a></li><span style=display:none>tutorials</span><li class=side-menu__sub__item><a id=menu-link-/tutorials/beginners/basic-ml/tutorial_basic_regression/ class=side-menu__sub__item__text href=/tutorials/beginners/basic-ml/tutorial_basic_regression/ data-url=/tutorials/beginners/basic-ml/tutorial_basic_regression/>Regression</a></li><span style=display:none>tutorials</span><li class="side-menu__sub__item active"><a id=menu-link-/tutorials/beginners/basic-ml/tutorial_basic_text_classification/ class=side-menu__sub__item__text href=/tutorials/beginners/basic-ml/tutorial_basic_text_classification/ data-url=/tutorials/beginners/basic-ml/tutorial_basic_text_classification/>Text Classification</a></li><span style=display:none>tutorials</span><li class=side-menu__sub__item><a id=menu-link-/tutorials/beginners/basic-ml/tutorial_basic_text_classification_with_tfhub/ class=side-menu__sub__item__text href=/tutorials/beginners/basic-ml/tutorial_basic_text_classification_with_tfhub/ data-url=/tutorials/beginners/basic-ml/tutorial_basic_text_classification_with_tfhub/>Transfer learning with tfhub</a></li><span style=display:none>tutorials</span><li class=side-menu__sub__item><a id=menu-link-/tutorials/beginners/basic-ml/tutorial_overfit_underfit/ class=side-menu__sub__item__text href=/tutorials/beginners/basic-ml/tutorial_overfit_underfit/ data-url=/tutorials/beginners/basic-ml/tutorial_overfit_underfit/>Overfitting and Underfitting</a></li><span style=display:none>tutorials</span><li class=side-menu__sub__item><a id=menu-link-/tutorials/beginners/basic-ml/tutorial_save_and_restore/ class=side-menu__sub__item__text href=/tutorials/beginners/basic-ml/tutorial_save_and_restore/ data-url=/tutorials/beginners/basic-ml/tutorial_save_and_restore/>Save and Restore Models</a></li></ul></li><li class=side-menu__item><a href=/tutorials/beginners/load/load_csv/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Load and preprocess data</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">Advanced</p></span></li><li class=side-menu__item><a href=/tutorials/advanced/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Quickstart</p></a></li><li class=side-menu__item><a href=/tutorials/advanced/customization/tensors-operations/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Customization</p></a></li><li class=side-menu__item><a href=/tutorials/advanced/images/cnn/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Images</p></a></li><li class=side-menu__item><a href=/tutorials/advanced/structured/classify/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Structured data</p></a></li><li class=side-menu__item><a href=/tutorials/advanced/distributed/distributed_training_with_keras/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Distributed training</p></a></li></ul><ul class=side-menu-list data-parenturl=/guide/ style=display:none><li class=side-menu__item><a href=/guide/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Overview</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">Keras</p></span></li><li class=side-menu__item><a href=/guide/keras/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Getting started</p></a></li><li class=side-menu__item><a href=/guide/keras/custom_layers/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Advanced</p></a></li><li class=side-menu__item><a href=/guide/keras/examples/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Examples</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">TensorFlow Mechanics</p></span></li><li class=side-menu__item><a href=/guide/tensorflow/eager_execution class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Basics</p></a></li><li class=side-menu__item><a href=/guide/tensorflow/ragged_tensors class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Advanced</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">Data input pipeline</p></span></li><li class=side-menu__item><a href=/guide/tfdatasets/introduction class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Overview</p></a></li><li class=side-menu__item><a href=/guide/tfdatasets/feature_spec class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Feature spec API</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">TensorFlow Hub</p></span></li><li class=side-menu__item><a href=/guide/tfhub/intro class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Basics</p></a></li><li class=side-menu__item><a href=/guide/tfhub/key-concepts class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Key concepts</p></a></li><li class=side-menu__item><a href=/guide/tfhub/examples/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Examples</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">Model saving</p></span></li><li class=side-menu__item><a href=/guide/saving/checkpoints class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Checkpoints</p></a></li><li class=side-menu__item><a href=/guide/saving/saved_model class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Saved Model</p></a></li><li class=side-menu__item><span class=side-menu__item__link><p class="side-menu__item__link__text side-menu__item__link__text__block">Estimators</p></span></li><li class=side-menu__item><a href=/tfestimators class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Basics</p></a></li><li class=side-menu__item><a href=/guide/tfestimators/creating_estimators/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Advanced</p></a></li><li class=side-menu__item><a href=/guide/tfestimators/examples class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Examples</p></a></li></ul><ul class=side-menu-list data-parenturl=/deploy/ style=display:none><li class=side-menu__item><a href=/deploy/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Overview</p></a></li><li class=side-menu__item><a href=/deploy/plumber/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Plumber</p></a></li><li class=side-menu__item><a href=/deploy/shiny/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Shiny</p></a></li><li class=side-menu__item><a href=/deploy/docker/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>TensorFlow Serving</p></a></li><li class=side-menu__item><a href=/deploy/rsconnect/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>RStudio Connect</p></a></li></ul><ul class=side-menu-list data-parenturl=/tools/ style=display:none><li class=side-menu__item><a href=/tools/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Overview</p></a></li><li class=side-menu__item><a href=/tools/tfruns/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Training Runs</p></a></li><li class=side-menu__item><a href=/tools/cloudml/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Cloud ML</p></a></li><li class=side-menu__item><a href=/tools/tensorboard/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Tensorboard</p></a></li></ul><ul class=side-menu-list data-parenturl=/reference/keras style=display:none><li class=side-menu__item><a href=/reference/cloudml/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>cloudml</p></a></li><li class=side-menu__item><a href=/reference/keras/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>keras</p></a></li><li class=side-menu__item><a href=/reference/tensorflow/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>tensorflow</p></a></li><li class=side-menu__item><a href=/reference/tfdatasets/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>tfdatasets</p></a></li><li class=side-menu__item><a href=/reference/tfestimators/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>tfestimators</p></a></li><li class=side-menu__item><a href=/reference/tfruns/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>tfruns</p></a></li></ul><ul class=side-menu-list data-parenturl=/learn/resources/ style=display:none><li class=side-menu__item><a href=/learn/resources/ class=side-menu__item__link><img class=side-menu__item__link__icon src=/images/icons/block-retina.png alt><p class=side-menu__item__link__text>Resources</p></a></li></ul><ul class=side-menu-list data-parenturl=/blog.html style=display:none></ul></div><div class=content><h1 class=content-header>Text Classification</h1><div class=markdowned><div class=doc-page><div class=doc-page-index><ul id=gumshoe-container data-gumshoe></ul></div><div class=doc-page-body><blockquote><p>Note: This tutorial requires TensorFlow version &gt;= 2.1</p></blockquote><p>This tutorial classifies movie reviews as positive or negative using the text of the review. This is an example of binary — or two-class — classification, an important and widely applicable kind of machine learning problem.</p><p>We’ll use the <a href=https://keras.rstudio.com/reference/dataset_imdb.html>IMDB dataset</a> that contains the text of 50,000 movie reviews from the <a href=https://www.imdb.com/>Internet Movie Database</a>. These are split into 25,000 reviews for training and 25,000 reviews for testing. The training and testing sets are balanced, meaning they contain an equal number of positive and negative reviews.</p><p>Let’s start and load Keras, as well as a few other required libraries.</p><div class=sourceCode id=cb1><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb1-1 data-line-number=1><span class=kw><a href=https://rdrr.io/r/base/library.html>library</a></span>(keras)</a>
<a class=sourceLine id=cb1-2 data-line-number=2><span class=kw><a href=https://rdrr.io/r/base/library.html>library</a></span>(dplyr)</a>
<a class=sourceLine id=cb1-3 data-line-number=3><span class=kw><a href=https://rdrr.io/r/base/library.html>library</a></span>(ggplot2)</a>
<a class=sourceLine id=cb1-4 data-line-number=4><span class=kw><a href=https://rdrr.io/r/base/library.html>library</a></span>(purrr)</a></code></pre></div><div id=download-the-movie-reviews-dataset class="section level2"><h2>Download the Movie Reviews dataset</h2><p>We will use the Movie Reviews dataset created by Bo Pang and Lillian Lee. This dataset is
redistributed with NLTK with permission from the authors.</p><p>The dataset can be found <a href=https://www.kaggle.com/nltkdata/movie-review#movie_review.csv>here</a>
and can be downloaded from the Kaggle UI or using the <a href=https://github.com/rstudio/pins>pins</a>
package.</p><p>If you are going to use <a href=https://github.copm/rstudio/pins>pins</a> follow this <a href=https://rstudio.github.io/pins/articles/boards-kaggle.html>tutorial</a> to register
the Kaggle board. Then you can run:</p><div class=sourceCode id=cb2><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb2-1 data-line-number=1>paths &lt;-<span class=st> </span>pins<span class=op>::</span><span class=kw><a href=https://rdrr.io/pkg/pins/man/pin_get.html>pin_get</a></span>(<span class=st>"nltkdata/movie-review"</span>, <span class=st>"kaggle"</span>)</a>
<a class=sourceLine id=cb2-2 data-line-number=2><span class=co># we only need the movie_review.csv file</span></a>
<a class=sourceLine id=cb2-3 data-line-number=3>path &lt;-<span class=st> </span>paths[<span class=dv>1</span>]</a></code></pre></div><p>Now let’s read it to R using the <code>read_csv</code> funcntion from the <code>readr</code> package.</p><div class=sourceCode id=cb3><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb3-1 data-line-number=1>df &lt;-<span class=st> </span>readr<span class=op>::</span><span class=kw><a href=https://readr.tidyverse.org/reference/read_delim.html>read_csv</a></span>(path)</a></code></pre></div><pre><code>## Parsed with column specification:
## cols(
##   fold_id = col_double(),
##   cv_tag = col_character(),
##   html_id = col_double(),
##   sent_id = col_double(),
##   text = col_character(),
##   tag = col_character()
## )</code></pre><div class=sourceCode id=cb5><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb5-1 data-line-number=1><span class=kw><a href=https://rdrr.io/r/utils/head.html>head</a></span>(df)</a></code></pre></div><pre><code>## # A tibble: 6 x 6
##   fold_id cv_tag html_id sent_id text                                 tag  
##     &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                                &lt;chr&gt;
## 1       0 cv000    29590       0 films adapted from comic books have… pos  
## 2       0 cv000    29590       1 for starters , it was created by al… pos  
## 3       0 cv000    29590       2 to say moore and campbell thoroughl… pos  
## 4       0 cv000    29590       3 "the book ( or \" graphic novel , \… pos  
## 5       0 cv000    29590       4 in other words , don't dismiss this… pos  
## 6       0 cv000    29590       5 if you can get past the whole comic… pos</code></pre></div><div id=explore-the-data class="section level2"><h2>Explore the data</h2><p>Let’s take a moment to understand the format of the data. The dataset has 60k rows, each
one representing a movie review. The <code>text</code> column has the actual review and the <code>tag</code>
represents shows us the classified sentiment for the review.</p><div class=sourceCode id=cb7><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb7-1 data-line-number=1>df <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=https://dplyr.tidyverse.org/reference/tally.html>count</a></span>(tag)</a></code></pre></div><pre><code>## # A tibble: 2 x 2
##   tag       n
##   &lt;chr&gt; &lt;int&gt;
## 1 neg   31783
## 2 pos   32937</code></pre><p>Around half of the reviews are negative and the other half are positive.
Here is an example of a review:</p><div class=sourceCode id=cb9><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb9-1 data-line-number=1>df<span class=op>$</span>text[<span class=dv>1</span>]</a></code></pre></div><pre><code>## [1] "films adapted from comic books have had plenty of success , whether they're about superheroes ( batman , superman , spawn ) , or geared toward kids ( casper ) or the arthouse crowd ( ghost world ) , but there's never really been a comic book like from hell before ."</code></pre><p>Let’s also split our dataset into training and testing:</p><div class=sourceCode id=cb11><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb11-1 data-line-number=1>training_id &lt;-<span class=st> </span><span class=kw><a href=https://rdrr.io/r/base/sample.html>sample.int</a></span>(<span class=kw><a href=https://rdrr.io/r/base/nrow.html>nrow</a></span>(df), <span class=dt>size =</span> <span class=kw><a href=https://rdrr.io/r/base/nrow.html>nrow</a></span>(df)<span class=op>*</span><span class=fl>0.8</span>)</a>
<a class=sourceLine id=cb11-2 data-line-number=2>training &lt;-<span class=st> </span>df[training_id,]</a>
<a class=sourceLine id=cb11-3 data-line-number=3>testing &lt;-<span class=st> </span>df[<span class=op>-</span>training_id,]</a></code></pre></div><p>It’s also useful to find out what is the distribution of the number of words
in each review.</p><div class=sourceCode id=cb12><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb12-1 data-line-number=1>df<span class=op>$</span>text <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-2 data-line-number=2><span class=st>  </span><span class=kw><a href=https://rdrr.io/r/base/strsplit.html>strsplit</a></span>(<span class=st>" "</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-3 data-line-number=3><span class=st>  </span><span class=kw><a href=https://rdrr.io/r/base/lapply.html>sapply</a></span>(length) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb12-4 data-line-number=4><span class=st>  </span><span class=kw><a href=https://rdrr.io/r/base/summary.html>summary</a></span>()</a></code></pre></div><pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1.00   14.00   21.00   23.06   30.00  179.00</code></pre></div><div id=prepare-the-data class="section level2"><h2>Prepare the data</h2><p>The reviews — the text — must be converted to tensors before fed into the neural network.
First, we create a dictionary and represent each of the 10,000 most common words by an integer. In this case, every review will be represented by a sequence of integers.</p><p>Then we can represent reviews in a couple of ways:</p><ul><li><p>One-hot-encode the arrays to convert them into vectors of 0s and 1s. For example, the sequence [3, 5] would become a 10,000-dimensional vector that is all zeros except for indices 3 and 5, which are ones. Then, make this the first layer in our network — a <code>dense</code> layer — that can handle floating point vector data. This approach is memory intensive, though, requiring a <code>num_words * num_reviews</code> size matrix.</p></li><li><p>Alternatively, we can pad the arrays so they all have the same length, then create an integer tensor of shape <code>num_examples * max_length</code>. We can use an embedding layer capable of handling this shape as the first layer in our network.</p></li></ul><p>In this tutorial, we will use the second approach.
Now, let’s define our Text Vectorization layer, it will be responsible to take
the string input and convert it to a Tensor.</p><div class=sourceCode id=cb14><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb14-1 data-line-number=1>num_words &lt;-<span class=st> </span><span class=dv>10000</span></a>
<a class=sourceLine id=cb14-2 data-line-number=2>max_length &lt;-<span class=st> </span><span class=dv>50</span></a>
<a class=sourceLine id=cb14-3 data-line-number=3>text_vectorization &lt;-<span class=st> </span><span class=kw><a href=../../../keras/reference/layer_text_vectorization.html>layer_text_vectorization</a></span>(</a>
<a class=sourceLine id=cb14-4 data-line-number=4>  <span class=dt>max_tokens =</span> num_words, </a>
<a class=sourceLine id=cb14-5 data-line-number=5>  <span class=dt>output_sequence_length =</span> max_length, </a>
<a class=sourceLine id=cb14-6 data-line-number=6>)</a></code></pre></div><p>Now, we need to <code>adapt</code> the Text Vectorization layer. It’s when we call <code>adapt</code>
that the layer will learn about unique words in our dataset and assign an integer
value for each one.</p><div class=sourceCode id=cb15><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb15-1 data-line-number=1>text_vectorization <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb15-2 data-line-number=2><span class=st>  </span><span class=kw><a href=../../../keras/reference/adapt.html>adapt</a></span>(df<span class=op>$</span>text)</a></code></pre></div><p>We can now see the vocabulary is in our text vectorization layer.</p><div class=sourceCode id=cb16><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb16-1 data-line-number=1><span class=co># </span><span class=al>TODO</span><span class=co> see https://github.com/tensorflow/tensorflow/pull/34529</span></a>
<a class=sourceLine id=cb16-2 data-line-number=2><span class=kw><a href=../../../keras/reference/get_vocabulary.html>get_vocabulary</a></span>(text_vectorization)</a></code></pre></div><p>You can see how the text vectorization layer transforms it’s inputs:</p><div class=sourceCode id=cb17><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb17-1 data-line-number=1><span class=kw>text_vectorization</span>(<span class=kw><a href=https://rdrr.io/r/base/matrix.html>matrix</a></span>(df<span class=op>$</span>text[<span class=dv>1</span>], <span class=dt>ncol =</span> <span class=dv>1</span>))</a></code></pre></div><pre><code>## tf.Tensor(
## [[  68 2835   30  359 1662   33   91 1056    5  632  631  321   41 7803
##    709 4865 1767   48 7600 1337  398 5161   48    2    1 1808 1800  148
##     17  140  109   90   69    3  359  408   40   30  503  142    0    0
##      0    0    0    0    0    0    0    0]], shape=(1, 50), dtype=int64)</code></pre></div><div id=build-the-model class="section level2"><h2>Build the model</h2><p>The neural network is created by stacking layers — this requires two main architectural decisions:</p><ul><li>How many layers to use in the model?</li><li>How many hidden units to use for each layer?</li></ul><p>In this example, the input data consists of an array of word-indices. The labels to predict are either 0 or 1. Let’s build a model for this problem:</p><div class=sourceCode id=cb19><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb19-1 data-line-number=1>input &lt;-<span class=st> </span><span class=kw><a href=../../../keras/reference/layer_input.html>layer_input</a></span>(<span class=dt>shape =</span> <span class=kw><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=dv>1</span>), <span class=dt>dtype =</span> <span class=st>"string"</span>)</a>
<a class=sourceLine id=cb19-2 data-line-number=2></a>
<a class=sourceLine id=cb19-3 data-line-number=3>output &lt;-<span class=st> </span>input <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb19-4 data-line-number=4><span class=st>  </span><span class=kw>text_vectorization</span>() <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb19-5 data-line-number=5><span class=st>  </span><span class=kw><a href=../../../keras/reference/layer_embedding.html>layer_embedding</a></span>(<span class=dt>input_dim =</span> num_words <span class=op>+</span><span class=st> </span><span class=dv>1</span>, <span class=dt>output_dim =</span> <span class=dv>16</span>) <span class=op>%&gt;%</span></a>
<a class=sourceLine id=cb19-6 data-line-number=6><span class=st>  </span><span class=kw><a href=../../../keras/reference/layer_global_average_pooling_1d.html>layer_global_average_pooling_1d</a></span>() <span class=op>%&gt;%</span></a>
<a class=sourceLine id=cb19-7 data-line-number=7><span class=st>  </span><span class=kw><a href=../../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>16</span>, <span class=dt>activation =</span> <span class=st>"relu"</span>) <span class=op>%&gt;%</span></a>
<a class=sourceLine id=cb19-8 data-line-number=8><span class=st>  </span><span class=kw><a href=../../../keras/reference/layer_dropout.html>layer_dropout</a></span>(<span class=fl>0.5</span>) <span class=op>%&gt;%</span><span class=st> </span></a>
<a class=sourceLine id=cb19-9 data-line-number=9><span class=st>  </span><span class=kw><a href=../../../keras/reference/layer_dense.html>layer_dense</a></span>(<span class=dt>units =</span> <span class=dv>1</span>, <span class=dt>activation =</span> <span class=st>"sigmoid"</span>)</a>
<a class=sourceLine id=cb19-10 data-line-number=10></a>
<a class=sourceLine id=cb19-11 data-line-number=11>model &lt;-<span class=st> </span><span class=kw><a href=../../../keras/reference/keras_model.html>keras_model</a></span>(input, output)</a></code></pre></div><p>The layers are stacked sequentially to build the classifier:</p><ul><li>The first layer is an <code>embedding</code> layer. This layer takes the integer-encoded vocabulary and looks up the embedding vector for each word-index. These vectors are learned as the model trains. The vectors add a dimension to the output array. The resulting dimensions are: (<code>batch, sequence, embedding</code>).</li><li>Next, a <code>global_average_pooling_1d</code> layer returns a fixed-length output vector for each example by averaging over the sequence dimension. This allows the model to handle input of variable length, in the simplest way possible.</li><li>This fixed-length output vector is piped through a fully-connected (<code>dense</code>) layer with 16 hidden units.</li><li>The last layer is densely connected with a single output node. Using the <code>sigmoid</code> activation function, this value is a float between 0 and 1, representing a probability, or confidence level.</li></ul><div id=hidden-units class="section level3"><h3>Hidden units</h3><p>The above model has two intermediate or “hidden” layers, between the input and output. The number of outputs (units, nodes, or neurons) is the dimension of the representational space for the layer. In other words, the amount of freedom the network is allowed when learning an internal representation.</p><p>If a model has more hidden units (a higher-dimensional representation space), and/or more layers, then the network can learn more complex representations. However, it makes the network more computationally expensive and may lead to learning unwanted patterns — patterns that improve performance on training data but not on the test data. This is called overfitting, and we’ll explore it later.</p></div><div id=loss-function-and-optimizer class="section level3"><h3>Loss function and optimizer</h3><p>A model needs a loss function and an optimizer for training. Since this is a binary classification problem and the model outputs a probability (a single-unit layer with a sigmoid activation), we’ll use the <code>binary_crossentropy</code> loss function.</p><p>This isn’t the only choice for a loss function, you could, for instance, choose <code>mean_squared_error</code>. But, generally, binary_crossentropy is better for dealing with probabilities — it measures the “distance” between probability distributions, or in our case, between the ground-truth distribution and the predictions.</p><p>Later, when we are exploring regression problems (say, to predict the price of a house), we will see how to use another loss function called mean squared error.</p><p>Now, configure the model to use an optimizer and a loss function:</p><div class=sourceCode id=cb20><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb20-1 data-line-number=1>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../../keras/reference/reexports.html>compile</a></span>(</a>
<a class=sourceLine id=cb20-2 data-line-number=2>  <span class=dt>optimizer =</span> <span class=st>'adam'</span>,</a>
<a class=sourceLine id=cb20-3 data-line-number=3>  <span class=dt>loss =</span> <span class=st>'binary_crossentropy'</span>,</a>
<a class=sourceLine id=cb20-4 data-line-number=4>  <span class=dt>metrics =</span> <span class=kw><a href=https://rdrr.io/r/base/list.html>list</a></span>(<span class=st>'accuracy'</span>)</a>
<a class=sourceLine id=cb20-5 data-line-number=5>)</a></code></pre></div></div></div><div id=train-the-model class="section level2"><h2>Train the model</h2><p>Train the model for 20 epochs in mini-batches of 512 samples. This is 20 iterations over all samples in the x_train and y_train tensors. While training, monitor the model’s loss and accuracy on the 10,000 samples from the validation set:</p><div class=sourceCode id=cb21><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb21-1 data-line-number=1>history &lt;-<span class=st> </span>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../../keras/reference/reexports.html>fit</a></span>(</a>
<a class=sourceLine id=cb21-2 data-line-number=2>  training<span class=op>$</span>text,</a>
<a class=sourceLine id=cb21-3 data-line-number=3>  <span class=kw><a href=https://rdrr.io/r/base/numeric.html>as.numeric</a></span>(training<span class=op>$</span>tag <span class=op>==</span><span class=st> "pos"</span>),</a>
<a class=sourceLine id=cb21-4 data-line-number=4>  <span class=dt>epochs =</span> <span class=dv>10</span>,</a>
<a class=sourceLine id=cb21-5 data-line-number=5>  <span class=dt>batch_size =</span> <span class=dv>512</span>,</a>
<a class=sourceLine id=cb21-6 data-line-number=6>  <span class=dt>validation_split =</span> <span class=fl>0.2</span>,</a>
<a class=sourceLine id=cb21-7 data-line-number=7>  <span class=dt>verbose=</span><span class=dv>2</span></a>
<a class=sourceLine id=cb21-8 data-line-number=8>)</a></code></pre></div><pre><code>## Train on 41420 samples, validate on 10356 samples
## Epoch 1/10
## 41420/41420 - 1s - loss: 0.6921 - accuracy: 0.5185 - val_loss: 0.6898 - val_accuracy: 0.5410
## Epoch 2/10
## 41420/41420 - 0s - loss: 0.6862 - accuracy: 0.5600 - val_loss: 0.6805 - val_accuracy: 0.5965
## Epoch 3/10
## 41420/41420 - 0s - loss: 0.6716 - accuracy: 0.6050 - val_loss: 0.6633 - val_accuracy: 0.6400
## Epoch 4/10
## 41420/41420 - 0s - loss: 0.6468 - accuracy: 0.6515 - val_loss: 0.6399 - val_accuracy: 0.6619
## Epoch 5/10
## 41420/41420 - 0s - loss: 0.6161 - accuracy: 0.6796 - val_loss: 0.6184 - val_accuracy: 0.6747
## Epoch 6/10
## 41420/41420 - 0s - loss: 0.5875 - accuracy: 0.7029 - val_loss: 0.6039 - val_accuracy: 0.6808
## Epoch 7/10
## 41420/41420 - 1s - loss: 0.5632 - accuracy: 0.7212 - val_loss: 0.5963 - val_accuracy: 0.6831
## Epoch 8/10
## 41420/41420 - 0s - loss: 0.5448 - accuracy: 0.7336 - val_loss: 0.5917 - val_accuracy: 0.6863
## Epoch 9/10
## 41420/41420 - 0s - loss: 0.5297 - accuracy: 0.7442 - val_loss: 0.5937 - val_accuracy: 0.6842
## Epoch 10/10
## 41420/41420 - 0s - loss: 0.5165 - accuracy: 0.7539 - val_loss: 0.5953 - val_accuracy: 0.6868</code></pre></div><div id=evaluate-the-model class="section level2"><h2>Evaluate the model</h2><p>And let’s see how the model performs. Two values will be returned. Loss (a number which represents our error, lower values are better), and accuracy.</p><div class=sourceCode id=cb23><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb23-1 data-line-number=1>results &lt;-<span class=st> </span>model <span class=op>%&gt;%</span><span class=st> </span><span class=kw><a href=../../../keras/reference/reexports.html>evaluate</a></span>(testing<span class=op>$</span>text, <span class=kw><a href=https://rdrr.io/r/base/numeric.html>as.numeric</a></span>(testing<span class=op>$</span>tag <span class=op>==</span><span class=st> "pos"</span>), <span class=dt>verbose =</span> <span class=dv>0</span>)</a>
<a class=sourceLine id=cb23-2 data-line-number=2>results</a></code></pre></div><pre><code>## $loss
## [1] 0.5940198
## 
## $accuracy
## [1] 0.6830192</code></pre><p>This fairly naive approach achieves an accuracy of about 68%. With more advanced approaches, the model should get closer to 85%.</p></div><div id=create-a-graph-of-accuracy-and-loss-over-time class="section level2"><h2>Create a graph of accuracy and loss over time</h2><p><code>fit</code> returns a <code>keras_training_history</code> object whose <code>metrics</code> slot contains loss and metrics values recorded during training.
You can conveniently plot the loss and metrics curves like so:</p><div class=sourceCode id=cb25><pre class="sourceCode r"><code class="sourceCode r"><a class=sourceLine id=cb25-1 data-line-number=1><span class=kw><a href=https://rdrr.io/r/graphics/plot.html>plot</a></span>(history)</a></code></pre></div><p><img src=/tutorials/beginners/basic-ml/tutorial_basic_text_classification_files/figure-html/unnamed-chunk-16-1.png width=672></p><p>The evolution of loss and metrics can also be seen during training in the RStudio Viewer pane.</p><p>Notice the training loss decreases with each epoch and the training accuracy increases with each epoch. This is expected when using gradient descent optimization — it should minimize the desired quantity on every iteration.</p></div></div></div></div><footer>Copyright © 2015-2020 The TensorFlow Authors and RStudio, PBC.
<script type=text/javascript>(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');_st('install','Ne8tbLfE121Pkj3xMr_G','2.0.0');</script></footer></div></div></body></html>