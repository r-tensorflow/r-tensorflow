---
title: "About Keras Layers"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{About Keras Layers}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
type: docs
repo: https://github.com/rstudio/keras
menu:
  main:
    name: "About Keras Layers"
    identifier: "keras-about-keras-layers"
    parent: "keras-getting-started-top"
    weight: 35
---



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>Keras layers are the fundamental building block of keras models. Layers are created using a wide variety of <code>layer_</code> functions and are typically composed together by stacking calls to them using the pipe <code>%&gt;%</code> operator. For example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">model &lt;-<span class="st"> </span><span class="kw">keras_model_sequential</span>() </a>
<a class="sourceLine" id="cb1-2" data-line-number="2">model <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="st">  </span><span class="kw">layer_dense</span>(<span class="dt">units =</span> <span class="dv">32</span>, <span class="dt">input_shape =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">784</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="st">  </span><span class="kw">layer_activation</span>(<span class="st">'relu'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="st">  </span><span class="kw">layer_dense</span>(<span class="dt">units =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="st">  </span><span class="kw">layer_activation</span>(<span class="st">'softmax'</span>)</a></code></pre></div>
<p>A wide variety of layers are available, including:</p>
<ul>
<li><p><a href="https://keras.rstudio.com/reference/index.html#section-core-layers">Core Layers</a></p></li>
<li><p><a href="https://keras.rstudio.com/reference/index.html#section-convolutional-layers">Convolutional Layers</a></p></li>
<li><p><a href="https://keras.rstudio.com/reference/index.html#section-pooling-layers">Pooling Layers</a></p></li>
<li><p><a href="https://keras.rstudio.com/reference/index.html#section-activation-layers">Activation Layers</a></p></li>
<li><p><a href="https://keras.rstudio.com/reference/index.html#section-dropout-layers">Dropout Layers</a></p></li>
<li><p><a href="https://keras.rstudio.com/reference/index.html#section-locally-connected-layers">Locally-connected Layers</a></p></li>
<li><p><a href="https://keras.rstudio.com/reference/index.html#section-recurrent-layers">Recurrent Layers</a></p></li>
<li><p><a href="https://keras.rstudio.com/reference/index.html#section-embedding-layers">Embedding Layers</a></p></li>
<li><p><a href="https://keras.rstudio.com/reference/index.html#section-normalization-layers">Normalization Layers</a></p></li>
<li><p><a href="https://keras.rstudio.com/reference/index.html#section-noise-layers">Noise Layers</a></p></li>
<li><p><a href="https://keras.rstudio.com/reference/index.html#section-merge-layers">Merge Layers</a></p></li>
<li><p><a href="https://keras.rstudio.com/reference/index.html#section-layer-wrappers">Layer Wrappers</a></p></li>
</ul>
</div>
<div id="properties" class="section level2">
<h2>Properties</h2>
<p>All layers share the following properties:</p>
<ul>
<li><p><code>layer$name</code> — String, must be unique within a model.</p></li>
<li><p><code>layer$input_spec</code> — List of input specifications. Each entry describes one required input: (ndim, dtype). A layer with <code>n</code> input tensors must have an <code>input_spec</code> of length <code>n</code>.</p></li>
<li><p><code>layer$trainable</code> — Boolean, whether the layer weights will be updated during training.</p></li>
<li><p><code>layer$uses_learning_phase</code> – Whether any operation of the layer uses <code>K.in_training_phase()</code> or <code>K.in_test_phase()</code>.</p></li>
<li><p><code>layer$input_shape</code> — Input shape. Provided for convenience, but note that there may be cases in which this
attribute is ill-defined (e.g. a shared layer with multiple input shapes), in which case
requesting <code>input_shape</code> will result in an error. Prefer using <code>get_input_shape_at(layer, node_index)</code>.</p></li>
<li><p><code>layer$output_shape</code> — Output shape. See above.</p></li>
<li><p><code>layer$inbound_nodes</code> — List of nodes.</p></li>
<li><p><code>layer$outbound_nodes</code> — List of nodes.</p></li>
<li><p><code>layer$input</code>, <code>layer$output</code> — Input/output tensor(s). Note that if the layer is used more than
once (shared layer), this is ill-defined and will result in an error. In such cases, use <code>get_input_at(layer, node_index)</code>.</p></li>
<li><p><code>layer$input_mask</code>, <code>layer$output_mask</code> — Same as above, for masks.</p></li>
<li><p><code>layer$trainable_weights</code> — List of variables.</p></li>
<li><p><code>layer$non_trainable_weights</code> — List of variables.</p></li>
<li><p><code>layer$weights</code> — The concatenation of the lists trainable_weights and
non_trainable_weights (in this order).</p></li>
<li><p><code>layer$constraints</code> — Mapping of weights to constraints.</p></li>
</ul>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<p>The following functions are available for interacting with layers:</p>
<table class="ref-index">
<colgroup>
<col class="alias">
<col class="title">
</colgroup>
<tbody>
<tr>
<!--  --><td>
<code>get_config()</code> <code>from_config()</code>
</td>
<td>
<p>
Layer/Model configuration
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code>get_weights()</code> <code>set_weights()</code>
</td>
<td>
<p>
Layer/Model weights as R arrays
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code>count_params()</code>
</td>
<td>
<p>
Count the total number of scalars composing the weights.
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code>get_input_at()</code> <code>get_output_at()</code> <code>get_input_shape_at()</code> <code>get_output_shape_at()</code> <code>get_input_mask_at()</code> <code>get_output_mask_at()</code>
</td>
<td>
<p>
Retrieve tensors for layers with multiple nodes
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code>reset_states()</code>
</td>
<td>
<p>
Reset the states for a layer
</p>
</td>
</tr>
</tbody>
</table>
</div>
