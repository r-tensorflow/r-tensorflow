---
title: "About Keras Models"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{About Keras Models}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
type: docs
repo: https://github.com/rstudio/keras
menu:
  main:
    name: "About Keras Models"
    identifier: "keras-about-keras-models"
    parent: "keras-getting-started-top"
    weight: 37
---



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>There are two types of built-in models available in Keras: <a href="sequential_model.html">sequential models</a> and models created with the <a href="functional_api.html">functional API</a>. In addition, you can also create <a href="custom_models.html">custom models</a> that define their own forward-pass logic.</p>
<div id="sequential" class="section level3">
<h3>Sequential</h3>
<p>Sequential models are created using the <code>keras_model_sequential()</code> function and are composed of a set of linear layers:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">model &lt;-<span class="st"> </span><span class="kw">keras_model_sequential</span>() </a>
<a class="sourceLine" id="cb1-2" data-line-number="2">model <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="st">  </span><span class="kw">layer_dense</span>(<span class="dt">units =</span> <span class="dv">32</span>, <span class="dt">input_shape =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">784</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="st">  </span><span class="kw">layer_activation</span>(<span class="st">'relu'</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="st">  </span><span class="kw">layer_dense</span>(<span class="dt">units =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="st">  </span><span class="kw">layer_activation</span>(<span class="st">'softmax'</span>)</a></code></pre></div>
<p>Note that Keras objects are <a href="faq.html#why-are-keras-objects-modified-in-place">modified in place</a> which is why it’s not necessary for <code>model</code> to be assigned back to after the layers are added.</p>
<p>Learn more by reading the <a href="sequential_model.html">Guide to the Sequential Model</a>.</p>
</div>
<div id="functional" class="section level3">
<h3>Functional</h3>
<p>The functional API enables you to define more complex models, such as multi-output models, directed acyclic graphs, or models with shared layers. To create a model with the functional API compose a set of input and output layers then pass them to the <code>keras_model()</code> function:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">tweet_a &lt;-<span class="st"> </span><span class="kw">layer_input</span>(<span class="dt">shape =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">140</span>, <span class="dv">256</span>))</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">tweet_b &lt;-<span class="st"> </span><span class="kw">layer_input</span>(<span class="dt">shape =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">140</span>, <span class="dv">256</span>))</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co"># This layer can take as input a matrix and will return a vector of size 64</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">shared_lstm &lt;-<span class="st"> </span><span class="kw">layer_lstm</span>(<span class="dt">units =</span> <span class="dv">64</span>)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co"># When we reuse the same layer instance multiple times, the weights of the layer are also</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co"># being reused (it is effectively *the same* layer)</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">encoded_a &lt;-<span class="st"> </span>tweet_a <span class="op">%&gt;%</span><span class="st"> </span>shared_lstm</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">encoded_b &lt;-<span class="st"> </span>tweet_b <span class="op">%&gt;%</span><span class="st"> </span>shared_lstm</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co"># We can then concatenate the two vectors and add a logistic regression on top</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">predictions &lt;-<span class="st"> </span><span class="kw">layer_concatenate</span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(encoded_a, encoded_b), <span class="dt">axis=</span><span class="op">-</span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="st">  </span><span class="kw">layer_dense</span>(<span class="dt">units =</span> <span class="dv">1</span>, <span class="dt">activation =</span> <span class="st">'sigmoid'</span>)</a>
<a class="sourceLine" id="cb2-15" data-line-number="15"></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co"># We define a trainable model linking the tweet inputs to the predictions</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17">model &lt;-<span class="st"> </span><span class="kw">keras_model</span>(<span class="dt">inputs =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(tweet_a, tweet_b), <span class="dt">outputs =</span> predictions)</a></code></pre></div>
<p>Learn more by reading the <a href="functional_api.html">Guide to the Functional API</a>.</p>
</div>
<div id="custom" class="section level3">
<h3>Custom</h3>
<p>Custom models enable you to implement custom forward-pass logic (e.g. to encapsulate the logic associated with constructuing various types of models). See the article on <a href="custom_models.html">Writing Custom Keras Models</a> for additional documentation, including an example that demonstrates creating a custom model that encapsulates a simple multi-layer-perceptron model with optional dropout and batch normalization layers.</p>
</div>
</div>
<div id="properties" class="section level2">
<h2>Properties</h2>
<p>All models share the following properties:</p>
<ul>
<li><p><code>model$layers</code> — A flattened list of the layers comprising the model graph.</p></li>
<li><p><code>model$inputs</code> — List of input tensors.</p></li>
<li><p><code>model$outputs</code> — List of output tensors.</p></li>
</ul>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<p>These functions enable you to create, train, evaluate, persist, and generate predictions with models:</p>
<table class="ref-index">
<colgroup>
<col class="alias">
<col class="title">
</colgroup>
<tbody>
<tr>
<!--  --><td>
<code>keras_model()</code>
</td>
<td>
<p>
Keras Model
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code>keras_model_sequential()</code>
</td>
<td>
<p>
Keras Model composed of a linear stack of layers
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code>compile()</code>
</td>
<td>
<p>
Configure a Keras model for training
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code>fit()</code>
</td>
<td>
<p>
Train a Keras model
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code>evaluate()</code>
</td>
<td>
<p>
Evaluate a Keras model
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code>
</td>
<td>
<p>
Predict Method for Keras Models
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>
</td>
<td>
<p>
Print a summary of a model
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code>save_model_hdf5()</code> <code>load_model_hdf5()</code>
</td>
<td>
<p>
Save/Load models using HDF5 files
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code>get_layer()</code>
</td>
<td>
<p>
Retrieves a layer based on either its name (unique) or index.
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code>pop_layer()</code>
</td>
<td>
<p>
Remove the last layer in a model
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code>save_model_weights_hdf5()</code> <code>load_model_weights_hdf5()</code>
</td>
<td>
<p>
Save/Load model weights using HDF5 files
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code>get_weights()</code> <code>set_weights()</code>
</td>
<td>
<p>
Layer/Model weights as R arrays
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code>get_config()</code> <code>from_config()</code>
</td>
<td>
<p>
Layer/Model configuration
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code>model_to_json()</code> <code>model_from_json()</code>
</td>
<td>
<p>
Model configuration as JSON
</p>
</td>
</tr>
<tr>
<!--  --><td>
<code>model_to_yaml()</code> <code>model_from_yaml()</code>
</td>
<td>
<p>
Model configuration as YAML
</p>
</td>
</tr>
</tbody>
</table>
</div>
