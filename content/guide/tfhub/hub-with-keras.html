---
title: "TensorFlow Hub with Keras"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{TensorFlow Hub with Keras}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
type: docs
repo: https://github.com/rstudio/tfhub
menu:
  main:
    name: "Using with Keras"
    identifier: "tfhub-with-keras"
    parent: "tfhub-basics-top"
    weight: 20
---



<p><a href="http://tensorflow.org/hub">TensorFlow Hub</a> is a way to share pretrained model components. See the TensorFlow Module Hub for a searchable listing of pre-trained models. This tutorial demonstrates:</p>
<ol style="list-style-type: decimal">
<li>How to use TensorFlow Hub with Keras.</li>
<li>How to do image classification using TensorFlow Hub.</li>
<li>How to do simple transfer learning.</li>
</ol>
<div id="setup" class="section level2">
<h2>Setup</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(keras)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tfhub)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(magick)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; Linking to ImageMagick 6.9.10.74</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; Enabled features: freetype, lcms, webp</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; Disabled features: cairo, fontconfig, fftw, ghostscript, pango, rsvg, x11</span></a></code></pre></div>
</div>
<div id="an-imagenet-classifier" class="section level2">
<h2>An ImageNet classifier</h2>
<div id="download-the-classifier" class="section level3">
<h3>Download the classifier</h3>
<p>Use <code>layer_hub</code> to load a mobilenet and transform it into a Keras layer.
Any TensorFlow 2 compatible image classifier URL from tfhub.dev will work here.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">classifier_url &lt;-<span class="st"> "https://tfhub.dev/google/tf2-preview/mobilenet_v2/classification/2"</span> </a>
<a class="sourceLine" id="cb2-2" data-line-number="2">mobilenet_layer &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/tfhub/man/layer_hub.html">layer_hub</a></span>(<span class="dt">handle =</span> classifier_url)</a></code></pre></div>
<p>We can then create our Keras model:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">input &lt;-<span class="st"> </span><span class="kw"><a href="../../keras/reference/layer_input.html">layer_input</a></span>(<span class="dt">shape =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">224</span>, <span class="dv">224</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">output &lt;-<span class="st"> </span>input <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="kw">mobilenet_layer</span>()</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">model &lt;-<span class="st"> </span><span class="kw"><a href="../../keras/reference/keras_model.html">keras_model</a></span>(input, output)</a></code></pre></div>
</div>
<div id="run-it-on-a-single-image" class="section level3">
<h3>Run it on a single image</h3>
<p>Download a single image to try the model on.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">img &lt;-<span class="st"> </span><span class="kw"><a href="https://docs.ropensci.org/magick/reference/editing.html">image_read</a></span>(<span class="st">'https://storage.googleapis.com/download.tensorflow.org/example_images/grace_hopper.jpg'</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://docs.ropensci.org/magick/reference/transform.html">image_resize</a></span>(<span class="dt">geometry =</span> <span class="st">"224x224x3!"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://docs.ropensci.org/magick/reference/editing.html">image_data</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="st">  </span>abind<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/abind/man/abind.html">abind</a></span>(<span class="dt">along =</span> <span class="dv">0</span>) <span class="co"># expand to batch dimension</span></a></code></pre></div>
<p><img src="/guide/tfhub/hub-with-keras_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">result &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(model, img)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw"><a href="../../keras/reference/application_mobilenet.html">mobilenet_decode_predictions</a></span>(result[,<span class="op">-</span><span class="dv">1</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>])</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt;   class_name class_description    score</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; 1  n03763968  military_uniform 9.349113</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; 2  n03787032       mortarboard 5.385236</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; 3  n02817516          bearskin 5.267460</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; 4  n04350905              suit 5.178592</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; 5  n09835506        ballplayer 4.817981</span></a></code></pre></div>
</div>
</div>
<div id="simple-transfer-learning" class="section level2">
<h2>Simple transfer learning</h2>
<p>Using TF Hub it is simple to retrain the top layer of the model to recognize the
classes in our dataset.</p>
<div id="dataset" class="section level3">
<h3>Dataset</h3>
<p>For this example you will use the TensorFlow flowers dataset:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">data_root &lt;-<span class="st"> </span>pins<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/pins/man/pin.html">pin</a></span>(<span class="st">"https://storage.googleapis.com/download.tensorflow.org/example_images/flower_photos.tgz"</span>, <span class="st">"flower_photos"</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">data_root &lt;-<span class="st"> </span>fs<span class="op">::</span><span class="kw"><a href="http://fs.r-lib.org/reference/path_file.html">path_dir</a></span>(fs<span class="op">::</span><span class="kw"><a href="http://fs.r-lib.org/reference/path_file.html">path_dir</a></span>(data_root[<span class="dv">100</span>])) <span class="co"># go down 2 levels</span></a></code></pre></div>
<p>The simplest way to load this data into our model is using <code>image_data_generator</code></p>
<p>All of TensorFlow Hub’s image modules expect float inputs in the [0, 1] range. Use the image_data_generator’s rescale parameter to achieve this.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">image_generator &lt;-<span class="st"> </span><span class="kw"><a href="../../keras/reference/image_data_generator.html">image_data_generator</a></span>(<span class="dt">rescale =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">255</span>, <span class="dt">validation_split =</span> <span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">training_data &lt;-<span class="st"> </span><span class="kw"><a href="../../keras/reference/flow_images_from_directory.html">flow_images_from_directory</a></span>(</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  <span class="dt">directory =</span> data_root, </a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  <span class="dt">generator =</span> image_generator,</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">  <span class="dt">target_size =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">224</span>, <span class="dv">224</span>), </a>
<a class="sourceLine" id="cb7-6" data-line-number="6">  <span class="dt">subset =</span> <span class="st">"training"</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; Found 2939 images belonging to 5 classes.</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"></a>
<a class="sourceLine" id="cb7-10" data-line-number="10">validation_data &lt;-<span class="st"> </span><span class="kw"><a href="../../keras/reference/flow_images_from_directory.html">flow_images_from_directory</a></span>(</a>
<a class="sourceLine" id="cb7-11" data-line-number="11">  <span class="dt">directory =</span> data_root, </a>
<a class="sourceLine" id="cb7-12" data-line-number="12">  <span class="dt">generator =</span> image_generator,</a>
<a class="sourceLine" id="cb7-13" data-line-number="13">  <span class="dt">target_size =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">224</span>, <span class="dv">224</span>), </a>
<a class="sourceLine" id="cb7-14" data-line-number="14">  <span class="dt">subset =</span> <span class="st">"validation"</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15">)</a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; Found 731 images belonging to 5 classes.</span></a></code></pre></div>
<p>The resulting object is an iterator that returns <code>image_batch</code>, <code>label_batch pairs</code>.</p>
</div>
<div id="download-the-headless-model" class="section level3">
<h3>Download the headless model</h3>
<p>TensorFlow Hub also distributes models without the top classification layer. These
can be used to easily do transfer learning.</p>
<p>Any Tensorflow 2 compatible image feature vector URL from tfhub.dev will work here.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">feature_extractor_url &lt;-<span class="st"> "https://tfhub.dev/google/tf2-preview/mobilenet_v2/feature_vector/2"</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">feature_extractor_layer &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/tfhub/man/layer_hub.html">layer_hub</a></span>(<span class="dt">handle =</span> feature_extractor_url)</a></code></pre></div>
</div>
<div id="attach-a-classification-head" class="section level3">
<h3>Attach a classification head</h3>
<p>Now we can create our classification model by attaching a classification head into
the feature extractor layer. We define the following model:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">input &lt;-<span class="st"> </span><span class="kw"><a href="../../keras/reference/layer_input.html">layer_input</a></span>(<span class="dt">shape =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">224</span>, <span class="dv">224</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">output &lt;-<span class="st"> </span>input <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span><span class="kw">feature_extractor_layer</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="../../keras/reference/layer_dense.html">layer_dense</a></span>(<span class="dt">units =</span> training_data<span class="op">$</span>num_classes, <span class="dt">activation =</span> <span class="st">"softmax"</span>)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"></a>
<a class="sourceLine" id="cb9-6" data-line-number="6">model &lt;-<span class="st"> </span><span class="kw"><a href="../../keras/reference/keras_model.html">keras_model</a></span>(input, output)</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(model)</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; Model: "model_1"</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt; ___________________________________________________________________________</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt; Layer (type)                     Output Shape                  Param #     </span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; ===========================================================================</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">#&gt; input_2 (InputLayer)             [(None, 224, 224, 3)]         0           </span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#&gt; ___________________________________________________________________________</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt; keras_layer_1 (KerasLayer)       (None, 1280)                  2257984     </span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt; ___________________________________________________________________________</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">#&gt; dense (Dense)                    (None, 5)                     6405        </span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">#&gt; ===========================================================================</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">#&gt; Total params: 2,264,389</span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">#&gt; Trainable params: 6,405</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="co">#&gt; Non-trainable params: 2,257,984</span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt; ___________________________________________________________________________</span></a></code></pre></div>
</div>
<div id="train-the-model" class="section level3">
<h3>Train the model</h3>
<p>We can now train our model in the same way we would train any other Keras model.
We first use <code>compile</code> to configure the training process:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">model <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../../keras/reference/reexports.html">compile</a></span>(</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">    <span class="dt">loss =</span> <span class="st">"categorical_crossentropy"</span>,</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">    <span class="dt">optimizer =</span> <span class="st">"adam"</span>,</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">    <span class="dt">metrics =</span> <span class="st">"acc"</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6">  )</a></code></pre></div>
<p>We can then use the <code>fit</code> function to fit our model.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">model <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../../keras/reference/fit_generator.html">fit_generator</a></span>(</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">    training_data, </a>
<a class="sourceLine" id="cb11-4" data-line-number="4">    <span class="dt">steps_per_epoch =</span> training_data<span class="op">$</span>n<span class="op">/</span>training_data<span class="op">$</span>batch_size,</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">    <span class="dt">validation_data =</span> validation_data</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">  )</a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"> <span class="dv">1</span><span class="op">/</span><span class="dv">91</span> [..............................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">6</span><span class="op">:</span><span class="dv">59</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">2.1597</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.2500</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"> <span class="dv">2</span><span class="op">/</span><span class="dv">91</span> [..............................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">4</span><span class="op">:</span><span class="dv">50</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">2.0234</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.2500</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"> <span class="dv">3</span><span class="op">/</span><span class="dv">91</span> [..............................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">4</span><span class="op">:</span><span class="dv">06</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.9392</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.2604</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"> <span class="dv">4</span><span class="op">/</span><span class="dv">91</span> [<span class="op">&gt;</span>.............................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">3</span><span class="op">:</span><span class="dv">43</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.8559</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.2578</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"> <span class="dv">5</span><span class="op">/</span><span class="dv">91</span> [<span class="op">&gt;</span>.............................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">3</span><span class="op">:</span><span class="dv">29</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.7939</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.2688</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"> <span class="dv">6</span><span class="op">/</span><span class="dv">91</span> [<span class="op">&gt;</span>.............................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">3</span><span class="op">:</span><span class="dv">20</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.7611</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.2656</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"> <span class="dv">7</span><span class="op">/</span><span class="dv">91</span> [=<span class="er">&gt;</span>............................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">3</span><span class="op">:</span><span class="dv">12</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.7102</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.2857</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"> <span class="dv">8</span><span class="op">/</span><span class="dv">91</span> [=<span class="er">&gt;</span>............................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">3</span><span class="op">:</span><span class="dv">06</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.6744</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.2969</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"> <span class="dv">9</span><span class="op">/</span><span class="dv">91</span> [=<span class="er">&gt;</span>............................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">3</span><span class="op">:</span><span class="dv">01</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.6470</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.3090</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="dv">10</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">&gt;</span>...........................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">56</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.5961</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.3438</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"><span class="dv">11</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">&gt;</span>...........................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">52</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.5548</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.3693</span></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="dv">12</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">&gt;</span>...........................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">49</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.5335</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.3724</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="dv">13</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=&gt;</span>..........................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">45</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.5081</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.3822</span></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="dv">14</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=&gt;</span>..........................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">42</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.4650</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.4040</span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="dv">15</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=&gt;</span>..........................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">39</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.4283</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.4208</span></a>
<a class="sourceLine" id="cb11-23" data-line-number="23"><span class="dv">16</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">==&gt;</span>.........................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">36</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.4049</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.4355</span></a>
<a class="sourceLine" id="cb11-24" data-line-number="24"><span class="dv">17</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">==&gt;</span>.........................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">34</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.3780</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.4504</span></a>
<a class="sourceLine" id="cb11-25" data-line-number="25"><span class="dv">18</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">==&gt;</span>.........................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">31</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.3528</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.4635</span></a>
<a class="sourceLine" id="cb11-26" data-line-number="26"><span class="dv">19</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">===&gt;</span>........................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">29</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.3209</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.4819</span></a>
<a class="sourceLine" id="cb11-27" data-line-number="27"><span class="dv">20</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">===&gt;</span>........................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">28</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.3102</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.4812</span></a>
<a class="sourceLine" id="cb11-28" data-line-number="28"><span class="dv">21</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">===&gt;</span>........................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">26</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.2936</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.4851</span></a>
<a class="sourceLine" id="cb11-29" data-line-number="29"><span class="dv">22</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">====&gt;</span>.......................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">24</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.2857</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.4915</span></a>
<a class="sourceLine" id="cb11-30" data-line-number="30"><span class="dv">23</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">====&gt;</span>.......................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">21</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.2614</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.5027</span></a>
<a class="sourceLine" id="cb11-31" data-line-number="31"><span class="dv">24</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">====&gt;</span>.......................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">19</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.2584</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.5013</span></a>
<a class="sourceLine" id="cb11-32" data-line-number="32"><span class="dv">25</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=====&gt;</span>......................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">16</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.2345</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.5125</span></a>
<a class="sourceLine" id="cb11-33" data-line-number="33"><span class="dv">26</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=====&gt;</span>......................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">14</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.2108</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.5240</span></a>
<a class="sourceLine" id="cb11-34" data-line-number="34"><span class="dv">27</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=====&gt;</span>......................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">12</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.1883</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.5347</span></a>
<a class="sourceLine" id="cb11-35" data-line-number="35"><span class="dv">28</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">======&gt;</span>.....................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">10</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.1727</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.5402</span></a>
<a class="sourceLine" id="cb11-36" data-line-number="36"><span class="dv">29</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">======&gt;</span>.....................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">07</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.1663</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.5442</span></a>
<a class="sourceLine" id="cb11-37" data-line-number="37"><span class="dv">30</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">======&gt;</span>.....................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">05</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.1501</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.5531</span></a>
<a class="sourceLine" id="cb11-38" data-line-number="38"><span class="dv">31</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=======&gt;</span>....................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">03</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.1329</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.5635</span></a>
<a class="sourceLine" id="cb11-39" data-line-number="39"><span class="dv">32</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=======&gt;</span>....................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">2</span><span class="op">:</span><span class="dv">01</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.1239</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.5684</span></a>
<a class="sourceLine" id="cb11-40" data-line-number="40"><span class="dv">33</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=======&gt;</span>....................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">59</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.1145</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.5720</span></a>
<a class="sourceLine" id="cb11-41" data-line-number="41"><span class="dv">34</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">========&gt;</span>...................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">57</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.0936</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.5818</span></a>
<a class="sourceLine" id="cb11-42" data-line-number="42"><span class="dv">35</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">========&gt;</span>...................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">55</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.0829</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.5893</span></a>
<a class="sourceLine" id="cb11-43" data-line-number="43"><span class="dv">36</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">========&gt;</span>...................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">53</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.0715</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.5946</span></a>
<a class="sourceLine" id="cb11-44" data-line-number="44"><span class="dv">37</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=========&gt;</span>..................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">52</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.0607</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6005</span></a>
<a class="sourceLine" id="cb11-45" data-line-number="45"><span class="dv">38</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=========&gt;</span>..................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">50</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.0516</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6036</span></a>
<a class="sourceLine" id="cb11-46" data-line-number="46"><span class="dv">39</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=========&gt;</span>..................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">48</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.0429</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6058</span></a>
<a class="sourceLine" id="cb11-47" data-line-number="47"><span class="dv">40</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">==========&gt;</span>.................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">46</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.0343</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6094</span></a>
<a class="sourceLine" id="cb11-48" data-line-number="48"><span class="dv">41</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">==========&gt;</span>.................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">43</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.0224</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6136</span></a>
<a class="sourceLine" id="cb11-49" data-line-number="49"><span class="dv">42</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">==========&gt;</span>.................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">41</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.0111</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6190</span></a>
<a class="sourceLine" id="cb11-50" data-line-number="50"><span class="dv">43</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">===========&gt;</span>................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">39</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">1.0041</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6206</span></a>
<a class="sourceLine" id="cb11-51" data-line-number="51"><span class="dv">44</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">===========&gt;</span>................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">37</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.9873</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6278</span></a>
<a class="sourceLine" id="cb11-52" data-line-number="52"><span class="dv">45</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">===========&gt;</span>................] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">35</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.9763</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6313</span></a>
<a class="sourceLine" id="cb11-53" data-line-number="53"><span class="dv">46</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">============&gt;</span>...............] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">33</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.9691</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6352</span></a>
<a class="sourceLine" id="cb11-54" data-line-number="54"><span class="dv">47</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">============&gt;</span>...............] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">31</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.9597</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6403</span></a>
<a class="sourceLine" id="cb11-55" data-line-number="55"><span class="dv">48</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">============&gt;</span>...............] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">28</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.9488</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6458</span></a>
<a class="sourceLine" id="cb11-56" data-line-number="56"><span class="dv">49</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=============&gt;</span>..............] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">26</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.9399</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6486</span></a>
<a class="sourceLine" id="cb11-57" data-line-number="57"><span class="dv">50</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=============&gt;</span>..............] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">24</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.9343</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6519</span></a>
<a class="sourceLine" id="cb11-58" data-line-number="58"><span class="dv">51</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=============&gt;</span>..............] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">22</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.9260</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6556</span></a>
<a class="sourceLine" id="cb11-59" data-line-number="59"><span class="dv">52</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">==============&gt;</span>.............] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">20</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.9272</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6556</span></a>
<a class="sourceLine" id="cb11-60" data-line-number="60"><span class="dv">53</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">==============&gt;</span>.............] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">18</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.9198</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6586</span></a>
<a class="sourceLine" id="cb11-61" data-line-number="61"><span class="dv">54</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">==============&gt;</span>.............] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">16</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.9147</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6609</span></a>
<a class="sourceLine" id="cb11-62" data-line-number="62"><span class="dv">55</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">===============&gt;</span>............] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">14</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.9073</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6659</span></a>
<a class="sourceLine" id="cb11-63" data-line-number="63"><span class="dv">56</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">===============&gt;</span>............] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8992</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6708</span></a>
<a class="sourceLine" id="cb11-64" data-line-number="64"><span class="dv">57</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">===============&gt;</span>............] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">09</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8907</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6732</span></a>
<a class="sourceLine" id="cb11-65" data-line-number="65"><span class="dv">58</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">================&gt;</span>...........] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">07</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8834</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6767</span></a>
<a class="sourceLine" id="cb11-66" data-line-number="66"><span class="dv">59</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">================&gt;</span>...........] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">05</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8792</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6790</span></a>
<a class="sourceLine" id="cb11-67" data-line-number="67"><span class="dv">60</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">================&gt;</span>...........] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">03</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8740</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6812</span></a>
<a class="sourceLine" id="cb11-68" data-line-number="68"><span class="dv">61</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=================&gt;</span>..........] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">01</span> <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8671</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6829</span></a>
<a class="sourceLine" id="cb11-69" data-line-number="69"><span class="dv">62</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=================&gt;</span>..........] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>59s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8643</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6855</span> </a>
<a class="sourceLine" id="cb11-70" data-line-number="70"><span class="dv">63</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=================&gt;</span>..........] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>57s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8569</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6890</span></a>
<a class="sourceLine" id="cb11-71" data-line-number="71"><span class="dv">64</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">==================&gt;</span>.........] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>55s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8502</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6919</span></a>
<a class="sourceLine" id="cb11-72" data-line-number="72"><span class="dv">65</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">==================&gt;</span>.........] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>53s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8459</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6942</span></a>
<a class="sourceLine" id="cb11-73" data-line-number="73"><span class="dv">66</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">==================&gt;</span>.........] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>51s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8409</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6960</span></a>
<a class="sourceLine" id="cb11-74" data-line-number="74"><span class="dv">67</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">===================&gt;</span>........] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>49s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8343</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.6982</span></a>
<a class="sourceLine" id="cb11-75" data-line-number="75"><span class="dv">68</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">===================&gt;</span>........] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>47s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8290</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7004</span></a>
<a class="sourceLine" id="cb11-76" data-line-number="76"><span class="dv">69</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">===================&gt;</span>........] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>45s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8253</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7020</span></a>
<a class="sourceLine" id="cb11-77" data-line-number="77"><span class="dv">70</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">====================&gt;</span>.......] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>43s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8210</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7040</span></a>
<a class="sourceLine" id="cb11-78" data-line-number="78"><span class="dv">71</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">====================&gt;</span>.......] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>41s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8167</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7060</span></a>
<a class="sourceLine" id="cb11-79" data-line-number="79"><span class="dv">72</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">====================&gt;</span>.......] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>39s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8109</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7079</span></a>
<a class="sourceLine" id="cb11-80" data-line-number="80"><span class="dv">73</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=====================&gt;</span>......] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>37s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.8049</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7106</span></a>
<a class="sourceLine" id="cb11-81" data-line-number="81"><span class="dv">74</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=====================&gt;</span>......] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>35s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7998</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7120</span></a>
<a class="sourceLine" id="cb11-82" data-line-number="82"><span class="dv">75</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=====================&gt;</span>......] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>33s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7950</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7142</span></a>
<a class="sourceLine" id="cb11-83" data-line-number="83"><span class="dv">76</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">======================&gt;</span>.....] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>31s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7905</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7150</span></a>
<a class="sourceLine" id="cb11-84" data-line-number="84"><span class="dv">77</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">======================&gt;</span>.....] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>29s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7858</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7167</span></a>
<a class="sourceLine" id="cb11-85" data-line-number="85"><span class="dv">78</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">======================&gt;</span>.....] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>27s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7825</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7179</span></a>
<a class="sourceLine" id="cb11-86" data-line-number="86"><span class="dv">79</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=======================&gt;</span>....] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>25s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7768</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7207</span></a>
<a class="sourceLine" id="cb11-87" data-line-number="87"><span class="dv">80</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=======================&gt;</span>....] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>22s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7751</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7207</span></a>
<a class="sourceLine" id="cb11-88" data-line-number="88"><span class="dv">81</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=======================&gt;</span>....] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>20s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7709</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7226</span></a>
<a class="sourceLine" id="cb11-89" data-line-number="89"><span class="dv">82</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">========================&gt;</span>...] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>18s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7678</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7241</span></a>
<a class="sourceLine" id="cb11-90" data-line-number="90"><span class="dv">83</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">========================&gt;</span>...] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>16s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7640</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7255</span></a>
<a class="sourceLine" id="cb11-91" data-line-number="91"><span class="dv">84</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">========================&gt;</span>...] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>14s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7588</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7277</span></a>
<a class="sourceLine" id="cb11-92" data-line-number="92"><span class="dv">85</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=========================&gt;</span>..] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>12s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7582</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7283</span></a>
<a class="sourceLine" id="cb11-93" data-line-number="93"><span class="dv">86</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=========================&gt;</span>..] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>10s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7553</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7297</span></a>
<a class="sourceLine" id="cb11-94" data-line-number="94"><span class="dv">87</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">=========================&gt;</span>..] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>8s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7503</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7320</span> </a>
<a class="sourceLine" id="cb11-95" data-line-number="95"><span class="dv">88</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">==========================&gt;</span>.] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>6s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7485</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7330</span></a>
<a class="sourceLine" id="cb11-96" data-line-number="96"><span class="dv">89</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">==========================&gt;</span>.] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>4s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7459</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7334</span></a>
<a class="sourceLine" id="cb11-97" data-line-number="97"><span class="dv">90</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">==========================&gt;</span>.] <span class="op">-</span><span class="st"> </span>ETA<span class="op">:</span><span class="st"> </span>2s <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7435</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7343</span></a>
<a class="sourceLine" id="cb11-98" data-line-number="98"><span class="dv">91</span><span class="op">/</span><span class="dv">91</span> [<span class="op">==</span><span class="er">============================</span>] <span class="op">-</span><span class="st"> </span>202s 2s<span class="op">/</span>step <span class="op">-</span><span class="st"> </span>loss<span class="op">:</span><span class="st"> </span><span class="fl">0.7388</span> <span class="op">-</span><span class="st"> </span>acc<span class="op">:</span><span class="st"> </span><span class="fl">0.7358</span> <span class="op">-</span><span class="st"> </span>val_loss<span class="op">:</span><span class="st"> </span><span class="fl">0.4817</span> <span class="op">-</span><span class="st"> </span>val_acc<span class="op">:</span><span class="st"> </span><span class="fl">0.8290</span></a></code></pre></div>
<p>You can then export your model with:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../../keras/reference/save_model_tf.html">save_model_tf</a></span>(model, <span class="st">"model"</span>)</a></code></pre></div>
<p>You can also reload the <code>model_from_saved_model</code> function. Note that you need to
pass the <code>custom_object</code> with the definition of the KerasLayer since it/s not
a default Keras layer.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">reloaded_model &lt;-<span class="st"> </span><span class="kw"><a href="../../keras/reference/save_model_tf.html">load_model_tf</a></span>(<span class="st">"model"</span>)</a></code></pre></div>
<p>We can verify that the predictions of both the trained model and the reloaded
model are equal:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">steps &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(validation_data<span class="op">$</span>n<span class="op">/</span>validation_data<span class="op">$</span>batch_size)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span>(</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">  <span class="kw"><a href="../../keras/reference/predict_generator.html">predict_generator</a></span>(model, validation_data, <span class="dt">steps =</span> steps),</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">  <span class="kw"><a href="../../keras/reference/predict_generator.html">predict_generator</a></span>(reloaded_model, validation_data, <span class="dt">steps =</span> steps),</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>The saved model can also be loaded for inference later or be converted to
<a href="https://www.tensorflow.org/lite/convert/">TFLite</a> or <a href="https://github.com/tensorflow/tfjs-converter">TFjs</a>.</p>
</div>
</div>
