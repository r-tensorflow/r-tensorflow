---
title: "R Interface to Core TensorFlow API"
output: 
  html_document:
    toc: false
    toc_float: false
type: docs
menu:
  main:
    name: "Overview"
    identifier: "tensorflow-overview"
    parent: "tensorflow-using-tensorflow"
    weight: 10
---



<div id="build-status">
<p><a href="https://travis-ci.org/rstudio/tensorflow"><img src="https://travis-ci.org/rstudio/tensorflow.svg?branch=master" alt="Travis-CI Build Status"></a>
<a href="http://cran.r-project.org/package=tensorflow"><img src="http://www.r-pkg.org/badges/version/tensorflow" alt="CRAN_Status_Badge"></a></p>
</div>
<div id="overview" class="section level2">
<h2>Overview</h2>
<p>The core <a href="https://www.tensorflow.org/api_docs/python/index.html">TensorFlow API</a> is composed of a set of Python modules that enable constructing and executing TensorFlow graphs. The <strong>tensorflow</strong> package provides access to the complete TensorFlow API from within R.</p>
<p>This set of articles describes the use of the core low-level TensorFlow API. There are additionally two higher-level interfaces available (both of which are also documented on this website):</p>
<ol style="list-style-type: decimal">
<li><p><a href="../keras/">Keras</a> — High-level neural networks API developed with a focus on enabling fast experimentation. Keras features a user-friendly API that makes it easy to quickly prototype deep learning models. It also has built-in support for convolutional networks (for computer vision), recurrent networks (for sequence processing), and any combination of both.</p></li>
<li><p><a href="../tfestimators">TF Estimators</a> — High-level API that provides canned implementations of many model types including linear models, support vector machines, deep neural networks, state saving recurrent neural networks, and dynamic recurrent neural networks.</p></li>
</ol>
<p>Depending on your application it may be more appropriate to use one of these higher level APIs rather than the lower-level core TensorFlow API described here.</p>
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>To get started, install the tensorflow R package from GitHub as follows:</p>
<pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"rstudio/tensorflow"</span>)</code></pre>
<p>Then, use the <code><a href="../tensorflow/reference/install_tensorflow.html">install_tensorflow()</a></code> function to install TensorFlow:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tensorflow)
<span class="kw"><a href="../tensorflow/reference/install_tensorflow.html">install_tensorflow</a></span>()</code></pre>
<p>You can confirm that the installation succeeded with:</p>
<pre class="sourceCode r"><code class="sourceCode r">sess =<span class="st"> </span>tf<span class="op">$</span><span class="kw">Session</span>()
hello &lt;-<span class="st"> </span>tf<span class="op">$</span><span class="kw">constant</span>(<span class="st">'Hello, TensorFlow!'</span>)
sess<span class="op">$</span><span class="kw">run</span>(hello)</code></pre>
<p>This will provide you with a default installation of TensorFlow suitable for getting started with the tensorflow R package. See the <a href="installation.html">article on installation</a> to learn about more advanced options, including installing a version of TensorFlow that takes advantage of Nvidia GPUs if you have the correct CUDA libraries installed.</p>
</div>
<div id="example" class="section level2">
<h2>Example</h2>
<p>Here’s a simple example of making up some data in two dimensions and then fitting a line to it:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tensorflow)

<span class="co"># Create 100 phony x, y data points, y = x * 0.1 + 0.3</span>
x_data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span>(<span class="dv">100</span>, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">1</span>)
y_data &lt;-<span class="st"> </span>x_data <span class="op">*</span><span class="st"> </span><span class="fl">0.1</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.3</span>

<span class="co"># Try to find values for W and b that compute y_data = W * x_data + b</span>
<span class="co"># (We know that W should be 0.1 and b 0.3, but TensorFlow will</span>
<span class="co"># figure that out for us.)</span>
W &lt;-<span class="st"> </span>tf<span class="op">$</span><span class="kw">Variable</span>(tf<span class="op">$</span><span class="kw">random_uniform</span>(<span class="kw"><a href="../tensorflow/reference/shape.html">shape</a></span>(1L), <span class="fl">-1.0</span>, <span class="fl">1.0</span>))
b &lt;-<span class="st"> </span>tf<span class="op">$</span><span class="kw">Variable</span>(tf<span class="op">$</span><span class="kw">zeros</span>(<span class="kw"><a href="../tensorflow/reference/shape.html">shape</a></span>(1L)))
y &lt;-<span class="st"> </span>W <span class="op">*</span><span class="st"> </span>x_data <span class="op">+</span><span class="st"> </span>b

<span class="co"># Minimize the mean squared errors.</span>
loss &lt;-<span class="st"> </span>tf<span class="op">$</span><span class="kw">reduce_mean</span>((y <span class="op">-</span><span class="st"> </span>y_data) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
optimizer &lt;-<span class="st"> </span>tf<span class="op">$</span>train<span class="op">$</span><span class="kw">GradientDescentOptimizer</span>(<span class="fl">0.5</span>)
train &lt;-<span class="st"> </span>optimizer<span class="op">$</span><span class="kw">minimize</span>(loss)

<span class="co"># Launch the graph and initialize the variables.</span>
sess =<span class="st"> </span>tf<span class="op">$</span><span class="kw">Session</span>()
sess<span class="op">$</span><span class="kw">run</span>(tf<span class="op">$</span><span class="kw">global_variables_initializer</span>())

<span class="co"># Fit the line (Learns best fit is W: 0.1, b: 0.3)</span>
<span class="cf">for</span> (step <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">201</span>) {
  sess<span class="op">$</span><span class="kw">run</span>(train)
  <span class="cf">if</span> (step <span class="op">%%</span><span class="st"> </span><span class="dv">20</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)
    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(step, <span class="st">"-"</span>, sess<span class="op">$</span><span class="kw">run</span>(W), sess<span class="op">$</span><span class="kw">run</span>(b), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)
}</code></pre>
<p>The first part of this code builds the data flow graph. TensorFlow does not actually run any computation until the session is created and the <code>run</code> function is called.</p>
</div>
<div id="mnist-tutorials" class="section level2">
<h2>MNIST Tutorials</h2>
<p>To whet your appetite further, we suggest you check out what a classical machine learning problem looks like in TensorFlow. In the land of neural networks the most “classic” classical problem is the MNIST handwritten digit classification. We offer two introductions here, one for machine learning newbies, and one for pros. If you’ve already trained dozens of MNIST models in other software packages, please take the red pill. If you’ve never even heard of MNIST, definitely take the blue pill. If you’re somewhere in between, we suggest skimming blue, then red.</p>
<div style="width:100%; margin:auto; margin-bottom:10px; margin-top:20px; display: flex; flex-direction: row">
<p><a href="articles/tutorial_mnist_beginners.html" title="MNIST for ML Beginners tutorial">
<img width="450" height="291" style="flex-grow:1; flex-shrink:1; border: 1px solid black;" src="images/blue_pill.png" alt="MNIST for machine learning beginners tutorial"></a>
<a href="articles/tutorial_mnist_pros.html" title="Deep MNIST for ML Experts tutorial">
<img width="450" height="291" style="flex-grow:1; flex-shrink:1; border: 1px solid black;" src="images/red_pill.png" alt="Deep MNIST for machine learning experts tutorial"></a></p>
</div>
<p style="font-size:10px;">
Images licensed CC BY-SA 4.0; original by W. Carter
</p>
<p>If you’re already sure you want to learn and install TensorFlow you can skip these and charge ahead. Don’t worry, you’ll still get to see MNIST – we’ll also use MNIST as an example in our technical tutorial where we elaborate on TensorFlow features.</p>
</div>
<div id="recommended-next-steps" class="section level2">
<h2>Recommended Next Steps</h2>
<p>Once you’ve installed the base TensorFlow system and the tensorflow R package, you will likely want work though the series of tutorials that cover TensorFlow basics:</p>
<ul>
<li><a href="articles/tutorial_mnist_beginners.html">MNIST For ML Beginners</a></li>
<li><a href="articles/tutorial_mnist_pros.html">Deep MNIST for Experts</a></li>
<li><a href="articles/tutorial_tensorflow_mechanics.html">TensorFlow Mechanics 101</a></li>
</ul>
<p>These articles cover the core concepts of TensorFlow in more depth as well describe the details of using the TensorFlow API from R:</p>
<ul>
<li><a href="articles/basic_usage.html">TensorFlow API Basic Usage</a></li>
<li><a href="articles/using_tensorflow_api.html">Using the TensorFlow API from R</a></li>
</ul>
<p>These articles provide more in depth treatments of various topics:</p>
<ul>
<li><a href="articles/howto_variables.html">Variables: Creation, Initialization, Saving, and Loading</a></li>
<li><a href="articles/tutorial_tensorflow_mechanics.html">TensorFlow Mechanics 101</a></li>
<li><a href="articles/howto_summaries_and_tensorboard.html">TensorBoard: Visualizing Learning</a></li>
<li><a href="articles/howto_graph_viz.html">TensorBoard: Graph Visualization</a></li>
</ul>
<p>Finally, to learn more about neural networks you might enjoy the <a href="http://playground.tensorflow.org">TensorFlow playground</a>, which lets you tinker with a neural network in your browser.</p>
</div>
