---
title: Configure a Keras model for training
type: docs
repo: https://github.com/rstudio/keras
menu:
  main:
    name: Configure a Keras model for training - keras
    parent: keras-reference
aliases:
- /reference/keras/compile.keras.engine.training.Model.html
- /keras/reference/compile.keras.engine.training.Model.html
- /guide/keras/reference/compile.keras.engine.training.Model.html
- /tools/tools/keras/reference/compile.keras.engine.training.Model.html
- /installation/keras/reference/compile.keras.engine.training.Model.html
- /tutorials/keras/reference/compile.keras.engine.training.Model.html
- /guide/tools/keras/reference/compile.keras.engine.training.Model.html
- /deploy/keras/reference/compile.keras.engine.training.Model.html
- /tools/keras/reference/compile.keras.engine.training.Model.html
---
    
    <p>Configure a Keras model for training</p>

    <div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class='co'># S3 method for keras.engine.training.Model</span>
<span class='fu'><a href='https://rdrr.io/pkg/generics/man/compile.html'>compile</a></span>(
  <span class='no'>object</span>,
  <span class='no'>optimizer</span>,
  <span class='no'>loss</span>,
  <span class='kw'>metrics</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>loss_weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>sample_weight_mode</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>weighted_metrics</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>target_tensors</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>...</span>
)</code></pre></div>

    <h2 id="arguments">Arguments</h2>
    <table class="ref-arguments">
    
    <colgroup>
      <col class="name" />
      <col class="desc" />
    </colgroup>  
      
    <tr>
      <td>object</td>
      <td><p>Model object to compile.</p></td>
    </tr>
    <tr>
      <td>optimizer</td>
      <td><p>Name of optimizer or optimizer instance.</p></td>
    </tr>
    <tr>
      <td>loss</td>
      <td><p>Name of objective function or objective function. If the model
has multiple outputs, you can use a different loss on each output by
passing a dictionary or a list of objectives. The loss value that will be
minimized by the model will then be the sum of all individual losses.</p></td>
    </tr>
    <tr>
      <td>metrics</td>
      <td><p>List of metrics to be evaluated by the model during training
and testing. Typically you will use <code>metrics='accuracy'</code>. To specify
different metrics for different outputs of a multi-output model, you could
also pass a named list such as <code>metrics=list(output_a = 'accuracy')</code>.</p></td>
    </tr>
    <tr>
      <td>loss_weights</td>
      <td><p>Optional list specifying scalar coefficients to weight
the loss contributions of different model outputs. The loss value that will
be minimized by the model will then be the <em>weighted sum</em> of all indvidual
losses, weighted by the <code>loss_weights</code> coefficients.</p></td>
    </tr>
    <tr>
      <td>sample_weight_mode</td>
      <td><p>If you need to do timestep-wise sample weighting
(2D weights), set this to "temporal". <code>NULL</code> defaults to sample-wise
weights (1D). If the model has multiple outputs, you can use a different
<code>sample_weight_mode</code> on each output by passing a list of modes.</p></td>
    </tr>
    <tr>
      <td>weighted_metrics</td>
      <td><p>List of metrics to be evaluated and weighted
by sample_weight or class_weight during training and testing</p></td>
    </tr>
    <tr>
      <td>target_tensors</td>
      <td><p>By default, Keras will create a placeholder for the
model's target, which will be fed with the target data during
training. If instead you would like to use your own
target tensor (in turn, Keras will not expect external
data for these targets at training time), you
can specify them via the <code>target_tensors</code> argument. It should be
a single tensor (for a single-output sequential model),</p></td>
    </tr>
    <tr>
      <td>...</td>
      <td><p>When using the Theano/CNTK backends, these arguments
are passed into K.function. When using the TensorFlow backend,
these arguments are passed into <code>tf$Session()$run</code>.</p></td>
    </tr>
    </table>

    <h2 id="see-also">See also</h2>

    <div class='dont-index'><p>Other model functions: 
<code><a href='../evaluate.keras.engine.training.Model.html'>evaluate.keras.engine.training.Model</a>()</code>,
<code><a href='../evaluate_generator.html'>evaluate_generator</a>()</code>,
<code><a href='../fit.keras.engine.training.Model.html'>fit.keras.engine.training.Model</a>()</code>,
<code><a href='../fit_generator.html'>fit_generator</a>()</code>,
<code><a href='../get_config.html'>get_config</a>()</code>,
<code><a href='../get_layer.html'>get_layer</a>()</code>,
<code><a href='../keras_model_sequential.html'>keras_model_sequential</a>()</code>,
<code><a href='../keras_model.html'>keras_model</a>()</code>,
<code><a href='../multi_gpu_model.html'>multi_gpu_model</a>()</code>,
<code><a href='../pop_layer.html'>pop_layer</a>()</code>,
<code><a href='../predict.keras.engine.training.Model.html'>predict.keras.engine.training.Model</a>()</code>,
<code><a href='../predict_generator.html'>predict_generator</a>()</code>,
<code><a href='../predict_on_batch.html'>predict_on_batch</a>()</code>,
<code><a href='../predict_proba.html'>predict_proba</a>()</code>,
<code><a href='../summary.keras.engine.training.Model.html'>summary.keras.engine.training.Model</a>()</code>,
<code><a href='../train_on_batch.html'>train_on_batch</a>()</code></p></div>




